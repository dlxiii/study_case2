
% Which version of FVCOM are we using (for the forcing file formats)?
inputConf.FVCOM_version = '4.1';

% Location of grads file
inputConf.grid = [basedir,'/study_case2/gis_files/opmeshes/',...
    'dem_10_02_creation.14'];

%%%------------------------------------------------------------------------
%%%                           Spatial stuff
%%%                           ????????????
%%%------------------------------------------------------------------------

% Case name for the model inputs and outputs
% Change this to whatever you want
inputConf.casename = 'tokyobay';

% output coordinates (FVCOM only likes cartesian at the moment)
inputConf.coordType = 'cartesian'; % 'spherical' or 'cartesian' 
% input coordinates (what's my input bathy in?)
inputConf.coordInput = 'spherical'; % 'spherical' or 'cartesian'

% Input grid UTM Zone (if applicable)
% See: https://upload.wikimedia.org/wikipedia/commons/e/ed/Utm-zones.jpg
% As Utm-zones indicated, here should be 54-S, but here the utmZone should
% be tmzone (UTM longitudinal zone) and utmhemi (UTM hemisphere as array of
% 'N' or 'S' characters)
inputConf.utmZone = {'54 N'};

% Option to smooth the bathymetry data.
inputConf.smoothBathy = 'yes'; % 'yes' or 'no'.
if strcmpi(inputConf.smoothBathy, 'yes')
    % Set the smoothing factor and number of iterations (see smoothmesh).
    inputConf.smoothFactors = [0.5, 4]; % [factor, iterations]
end

% vertical coordinates type: sigma or hybrid
inputConf.verticalCoordType = 'sigma';


%%%------------------------------------------------------------------------
%%%                     Time and Model constants
%%%                     ?????????????????????????????????
%%%------------------------------------------------------------------------

% Model time ([Y,M,D,h,m,s])
inputConf.modelYear = 2014;
inputConf.startDate = [inputConf.modelYear,01,01,00,00,00];
inputConf.endDate = [inputConf.modelYear+2,01,01,00,00,00];

% Convert times to Modified Julian Date
inputConf.startDateMJD = greg2mjulian(inputConf.startDate(1),...
    inputConf.startDate(2),inputConf.startDate(3),inputConf.startDate(4),...
    inputConf.startDate(5),inputConf.startDate(6));
inputConf.endDateMJD = greg2mjulian(inputConf.endDate(1),...
    inputConf.endDate(2),inputConf.endDate(3),inputConf.endDate(4),...
    inputConf.endDate(5),inputConf.endDate(6));

% The number of months in the period of data.
inputConf.mm = inputConf.startDate(2):inputConf.endDate(2);
if inputConf.mm == 1
    inputConf.dOffsets = [0, 4];
elseif inputConf.mm == 12
    inputConf.dOffsets = [2, 0];
else
    inputConf.dOffsets = [2, 4];
end

% Sponge layer parameters
inputConf.spongeRadius = -1; % in metres, or -1 for variable
inputConf.spongeCoeff = 0.001;

% z0 value in metres
inputConf.bedRoughness = 0.015; % or 0.015, 0.025 or 0.03 - Davies and Furnes (1980) shelf model

% Estimated velocity (m/s) and tidal range (m) for time step estimate
inputConf.estVel = 1.5;
inputConf.estRange = 2.0;


%%%------------------------------------------------------------------------
%%%                       Forcing and stuff
%%%                       ?????????????????????
%%%------------------------------------------------------------------------

% Model time type ('non-julian' and 'julian')
inputConf.datetype = 'julian';
% Increment used for tide (days)
inputConf.datetide = 1/24;
% Model time is decided depend on the datetype.
if strcmpi(inputConf.datetype,'non-julian') 
    inputConf.modelTime = [...
        inputConf.startDateMJD, ...
        inputConf.endDateMJD];
elseif strcmpi(inputConf.datetype,'julian')
    inputConf.modelTime = [...
        inputConf.startDateMJD - inputConf.dOffsets(1), ...
        inputConf.endDateMJD + inputConf.dOffsets(2)];
end
% Open boundary forcing nodal forcing type (drived by OTPS).
inputConf.obcForcing = 'z'; 
inputConf.tidesMJD = inputConf.startDateMJD:inputConf.datetide:inputConf.endDateMJD;

% Increment used for open boundary ST (days)
inputConf.dateobs = 1/24;
% Open boundary temperatures and salinities (string for source or number for constant).
% The data is avaliable from 1992-10-02 00:00:00
inputConf.obc_temp = 'HYCOM';
inputConf.obc_salt = 'HYCOM';
inputConf.obc_u = 'NONE';
inputConf.obc_v = 'NONE';
inputConf.obctsMJD = [inputConf.startDateMJD, inputConf.endDateMJD + 1];
if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
  inputConf.Nested_type = 1;% [1, 2 == direct nesting, 3 == weighted]
  inputConf.levels = 1;% number of boundary bands to use for weighted option
  inputConf.power = 0;% [0 is linear, anything else is 1/conf.levels.^conf.power]
end

% Increment used for surface forcing (days)
inputConf.dateforcing = 1/24;
% The surface forcing from NCEP
% The data is avaliable from 1948 - present
inputConf.doForcing = 'GWO';
if strcmpi(inputConf.doForcing, 'GWO')
    inputConf.forceMJD = inputConf.startDateMJD:inputConf.dateforcing:inputConf.endDateMJD;
elseif strcmpi(inputConf.doForcing, 'NCEP')
    inputConf.forceMJD = [inputConf.startDateMJD, inputConf.endDateMJD];
end

% The river forcing from flux, salinity and temperature
inputConf.riverForcing = 'FLUX';
% % River information
% inputConf.river.infos = {...
%     'Edogawa',...
%     'Nakagawa',...
%     'Arakawa',...
%     'Sumidagawa',...
%     'Tamagawa',...
%     'Tsurumigawa',...
%     'Ebigawa'};
% % Location of river file
% inputConf.river.flux = [basedir,'river/data_q/river_flux.csv'];
% inputConf.river.temp = [basedir,'river/data_q/river_temp.csv'];
% inputConf.river.salt = [basedir,'river/data_q/river_salt.csv'];
% inputConf.river.location = [basedir,'river/data_q/river_location.csv'];

% River information
inputConf.river.infos = {...
    'Edogawa',...
    'Nakagawa',...
    'Arakawa',...
    'Sumidagawa',...
    'Tamagawa',...
    'Tsurumigawa'};
% Location of river file
inputConf.river.flux = ['river_flux.csv'];
inputConf.river.temp = ['river_temp.csv'];
inputConf.river.salt = ['river_salt.csv'];
inputConf.river.location = ['location.csv'];

% Adjust river mouth location
% 139??55'57.84"	139??50'55.07"	139??46'29.73"	139??46'46.94"	139??40'53.63"	139??58'41.66"
%  35??41'56.29"	 35??38'36.31"	 35??38'49.41"	 35??31'45.11"	 35??28'25.39"	 35??40'52.25"
% New Edogawa river mouth location
% 139.872575 (139??52'21.27")
% 35.63695833(35??38'13.05")

% Give some names to the boundaries. This must match the number of node
% strings defined in SMS. Ideally, the order of the names should match the
% order in which the boundaries were made in SMS.
inputConf.boundaryNames = {'pacific_ocean'};


% Stations
inputConf.names = {...
    'Tokyo',...
    'Chiba',...
    'Yokohamashinko',...
    'Daini-Kaiho',...
    'Yokosuka',...
    'Kyurihamako',...
%     'Tidal-Station-1',...
%     'Tidal-Station-2',...
%     'Tidal-Station-3',...
%     'Tidal-Station-4',...
    };
inputConf.positions = [...
    139.7700000000000,35.648888888888889;...
    140.0455555555556,35.568055555555556;...
    139.6441666666666,35.454166666666667;...
    139.7433333333333,35.308611111111105;...
    139.6513888888889,35.288055555555556;...
    139.7208333333333,35.227777777777778;...
%     139.6912777777778,35.062205555555556;...
%     139.7207861111112,35.076750000000004;...
%     139.7504166666667,35.093661111111111;...
%     139.7735055555556,35.127727777777778;...
    ];

% Make cross section courses
% 'Yoko_01': Tokyo-Chiba port;
% 'Yoko_02': Submarine high way
% 'Yoko_03': Inner bay boundary
% 'Yoko_04': Outer bay boundary
inputConf.crosssection = {...
    'Yoko_01',...
    'Yoko_02',...
    'Yoko_03',...
    'Yoko_04',...
    'Tate_01',...
    'Tate_02',...
    'Tate_03',...
    };
inputConf.endpoints = [...
    139.8977,35.6166,140.0374,35.5166;...
    139.8023,35.5112,139.9115,35.4378;...
    139.7373,35.2656,139.7849,35.3121;...
    139.6784,35.1397,139.7529,34.9784;...
    140.0433,35.6303,139.7209,35.3020;...
    139.7209,35.3020,139.7965,35.2395;...
    139.7965,35.2395,139.7095,35.0545;...
    ];
inputConf.crosssection_ds = 0.01;

[inputConf] = getCrossSectionPoints(inputConf);

% Generate coordinates
UTMzone = regexpi(inputConf.utmZone,'\ ','split');
for s = 1:length(inputConf.positions)
    [inputConf.positions(s,3),inputConf.positions(s,4),~,~] = wgs2utm(...
        inputConf.positions(s,2),inputConf.positions(s,1),...
        str2double(char(UTMzone{1}(1))),char(UTMzone{1}(2)));
end
clear s UTMzone

% The accepted distance error of cal and real, in the cartesian coordinate 
% system, the dist unit is meter.
inputConf.dist = 1100.00;

%%
%%%------------------------------------------------------------------------
%%%                      Model mesh generation
%%%                      ????????????
%%%------------------------------------------------------------------------

% Read the input mesh and bathymetry. Also creates the data necessary for
% the Coriolis correction in FVCOM.
Mobj = read_grid_mesh(...
    'grid',inputConf.grid,...
    'coordinate',inputConf.coordType,...
    'in_coord',inputConf.coordInput,...
    'project',true,...
    'zone',inputConf.utmZone,...
    'addCoriolis',true);
forward projecting to get (x,y)

% Smooth the bathymetry if desired.
if strcmpi(inputConf.smoothBathy, 'yes')
    Mobj = setup_metrics(Mobj);
    % Backup Mobj.h as Mobj.h_backup
    Mobj.h_backup_1 = Mobj.h;
    Mobj.h = smoothfield(Mobj.h, Mobj, ...
        inputConf.smoothFactors(1), inputConf.smoothFactors(2));
    Mobj.h_backup_2 = Mobj.h;
    Mobj.h = smoothfield(Mobj.h, Mobj, ...
        inputConf.smoothFactors(1), inputConf.smoothFactors(2));
    % smoothfield2 is really inappropriate for bathymetry data.
    % Mobj.h = smoothfield2(Mobj.h,Mobj,inputconf.smoothFactors(2));
    Mobj.h_delta = Mobj.h - Mobj.h_backup_1;
    plotMesh(01, [Mobj.lon, Mobj.lat], Mobj.tri, Mobj.h_delta);
end

% % Parse the open boundary nodes and add accordingly
% % Add the sponge nodes
% x_adj = Mobj.x;
% y_adj = Mobj.y;
% for i=1:size(Mobj.read_obc_nodes,2)
%     % For each of the open boundaries, find the points inside the
%     % boundary and move the closest existing point to that location.
%     % This should make the boundaries more orthogonal (as suggested by
%     % the FVCOM manual in Figure 6.2 on page 77 [as of 2013-03-11]).
%     % x= x3;
%     % y= y3;
%     % node_ids=Mobj.read_obc_nodes{1};
%     [x_adj, y_adj] = fix_inside_boundary(x_adj, y_adj, Mobj.read_obc_nodes{i});    
% end
% Mobj.x = x_adj;
% Mobj.y = y_adj;

% Parse the open boundary nodes and add accordingly
% Add the sponge nodes
for i=1:size(Mobj.read_obc_nodes,2)
    nodeList = double(cell2mat(Mobj.read_obc_nodes(i)));
    Mobj = add_obc_nodes_list(Mobj,nodeList,inputConf.boundaryNames{i},1,1);
    if inputConf.spongeRadius < 0    % if we want a variable sponge radius
        if i==1
            % Create an array to store the radii
            Mobj.sponge_rad = zeros(size(Mobj.sponge_nodes));
        end
        % calculate the sponge radius
        spongeRadius = calc_sponge_radius(Mobj,nodeList);
        % Add the sponge nodes to the list
        Mobj = add_sponge_nodes_list(Mobj,nodeList,...
            [inputConf.boundaryNames{i},' sponge'],spongeRadius,...
            inputConf.spongeCoeff);
    else
        Mobj = add_sponge_nodes_list(Mobj,nodeList,...
            [inputConf.boundaryNames{i},' sponge'],inputConf.spongeRadius,...
            inputConf.spongeCoeff);
    end
    clear nodeList spongeRadius
end
clear i

% Model time is decided depend on the datetype.
if strcmpi(inputConf.verticalCoordType,'sigma')
    % Get the sigma depths in order to interpolate from the depths
    if exist(fullfile(inputConf.outbase, [inputConf.casename,'_sigma.dat']),'file')
        % If the sigma.dat file exists, read it
        Mobj = read_sigma(Mobj, fullfile(inputConf.outbase, [inputConf.casename,'_sigma.dat']));
    else
        % If we can't find the sigma.dat file, print an error message and finish
        error(['sigma.dat not found. Please put your sigma.dat file into ',...
            fullfile(inputConf.outbase),' and try again.'])
    end
elseif strcmpi(inputConf.verticalCoordType,'hybrid')
    inputConf.hybrid.sigma_file = [inputConf.casename,'_hybrid.dat'];
    inputConf.hybrid.nlev = 11;                % number of vertical levels (layers + 1)
    inputConf.hybrid.H0 = 100;                 % transition depth of the hybrid coordinates
    inputConf.hybrid.KU = 2;                   % number of layers in the DU water column
    inputConf.hybrid.KL = 1;                   % number of layers in the DL water column
    inputConf.hybrid.DU = 20;                  % upper water boundary thickness (metres)
    inputConf.hybrid.DL = 10;                  % lower water boundary thickness (metres)
    Mobj = hybrid_coordinate(inputConf.hybrid, Mobj);
end

% Do the bed roughness
Mobj.z0 = ones(1,Mobj.nElems)*inputConf.bedRoughness;

% Generate center point coordination of elements
% Do the stations list
Mobj.xc = nodes2elems(Mobj.x, Mobj);
Mobj.yc = nodes2elems(Mobj.y, Mobj);
Mobj.lonc = nodes2elems(Mobj.lon, Mobj);
Mobj.latc = nodes2elems(Mobj.lat, Mobj);

% Add station
% Positions=inputConf.positions;Names=inputConf.names;Dist=inputConf.dist;plotFig=1;
Mobj = add_stations_list(Mobj,inputConf.positions,inputConf.names,inputConf.dist,1);

% Estimate model time step. Supply estimated velocity (m/s) and tidal range
% (m) after the mesh object.
Mobj = estimate_ts(Mobj,inputConf.estVel,inputConf.estRange);
fprintf('Estimated time step:\t%.2f\n',min(Mobj.ts));
Estimated time step:	9.64

%%
%%%------------------------------------------------------------------------
%%%                     Output of basic configurations
%%%                     ????????????
%%%------------------------------------------------------------------------

% Grid
write_FVCOM_grid(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_grd.dat']));
write_SMS_2dm(fullfile(inputConf.outbase,[inputConf.casename,'_grd.2dm']), Mobj.tri, Mobj.x, Mobj.y, Mobj.h);
% Bathymetry
write_FVCOM_bath(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_dep.dat']));
% Coriolis
write_FVCOM_cor(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_cor.dat']));
% Open boundaries
write_FVCOM_obc(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_obc.dat']))
% Sponge file
write_FVCOM_sponge(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_spg.dat']))
% Bed roughness (constant or variable (see above))
write_FVCOM_z0(Mobj.z0,fullfile(inputConf.outbase,[inputConf.casename,'_z0.nc']),'bottom roughness');
% Time series wave stations
write_FVCOM_stations(Mobj,fullfile(inputConf.outbase,[inputConf.casename,'_station.dat']));

% Save Model object file
if exist([inputConf.outbase,'varb'], 'dir')~=7
    mkdir([inputConf.outbase,'varb'])
end
save([inputConf.outbase,'varb/Mobj_00.mat'],'Mobj','-v7.3','-nocompression');

%%
%%%------------------------------------------------------------------------
%%%                    Additional forcing: Tides
%%%                    ??????????????? 
%%%------------------------------------------------------------------------
tic
% Open boundary nodal forcing type
%   'z' for predicted surface elevation
%   'phase-amp' for amplitudes and phases
%   'model-output' for Tidal Model Driver output
fprintf('Calculating open boundary forcing data from OTPS...\n')
Calculating open boundary forcing data from OTPS...
% Need to cd to TPXO directory or it doesn't work
inputConf.extractType = 'z'; 
% (Yes, this is inelegant but it's the easiest way for now)
here = pwd; % store the current working directory to return later
tpxo_dir = which('TMD');    % find the TPXO directory
tpxo_dir = tpxo_dir(1:end-5);   % remove TPXO.m
if strcmpi(inputConf.obcForcing, 'z')
    cd(tpxo_dir)    % go to TPXO directory
    % Location of the TMD model description file
    inputConf.Model = [tpxo_dir,'DATA/Model_OhS'];
elseif strcmpi(inputConf.obcForcing, 'phase-amp')
    cd(tpxo_dir)    % go to TPXO directory
    % Location of the TMD model description file
    inputConf.Model = [tpxo_dir,'DATA/Model_OhS'];
elseif strcmpi(inputConf.obcForcing, 'otps')
    fid=fopen([tpxo_dir,'LAT_LON/lat_lon_1st'],'w');
    fprintf('Rewriting %s...\n','lat_lon_1st');
    fprintf(fid,"   lat       lon             yy   mm   dd   hh   mi  sec  dt(min) TSLength\n");
    for i = 1:Mobj.nObcNodes
        fprintf(fid," %10.4f %10.4f %8d %4d %4d %4d %4d %4d %4d %10d\n",...
            Mobj.lat(i), Mobj.lon(i),...
            inputConf.startDate(1), inputConf.startDate(2),...
            inputConf.startDate(3), inputConf.startDate(4),...
            inputConf.startDate(5), inputConf.startDate(6),...
            inputConf.datetide*24*60, 1/inputConf.datetide*(inputConf.endDateMJD-inputConf.startDateMJD)+1);
    end
    fclose(fid);
    fprintf('Finishing rewriting %s...\n','lat_lon_1st');
end

% How many tidal constituents do we actually want to use at the model
% boundaries? Case sensitive (M2 != m2).
% Only relevant if using TPXO.
inputConf.tidalComponents = {'M2','S2','N2','K2','K1','O1','P1','Q1'};
% clear tpxo_dir

%%%------------------------------------------------------------------------
%%%                  Tides and its (non)julian output
%%%------------------------------------------------------------------------

% Generate a surface elevation time series for open boundary forcing.
if strcmpi(inputConf.obcForcing, 'z')
    if develop_mode == 3
        cd(here);
    	fprintf('Loading Model objet file...\n');
        load([inputConf.outbase,'varb/Mobj_01.mat']);
        fprintf('Done!\n');
    else
        % Use tmd_tide_pred to predict surface elevations for a given time range.
        % Add the tidal components to the Mobj.
        % Mobj.Components = conf.obc_tides.components;
        Mobj.Components = inputConf.tidalComponents;
        % Get the indices to use the tidal constituents defined in
        % conf.obc_tides.components for TPXO (which requires a
        % numerical array of the constituents to be used). The order of the
        % TPXO constituents is M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, M4,
        % MS4, MN4.
        tpxoConsts = {'M2', 'S2', 'N2', 'K2', 'K1', 'O1', 'P1', 'Q1'};
        tIndUse = nan(length(Mobj.Components), 1);
        tInd = 1:length(tpxoConsts);
        for i=1:length(Mobj.Components)
            tPos = tInd(strcmp(Mobj.Components{i}, tpxoConsts));
            if ~isempty(tPos)
                tIndUse(i) = tPos;
            else
                warning('Supplied constituent (%s) is not present in the TPXO data', Mobj.Components{i}); %#ok<WNTAG>
            end
        end
        % Tidy up a bit
        clear i c tpxoConsts tPos tInd
        tIndUse = tIndUse(~isnan(tIndUse));
        % We can't just use tmd_tide_pred to do all the surface elevations
        % at once. Instead, the useful approaches are:
        %   1. Time series at a single location
        %   2. Map of a given time step at all locations
        surfaceElevation = nan(Mobj.nObcNodes, size(inputConf.tidesMJD, 2), length(inputConf.boundaryNames));
        for i=1:length(inputConf.boundaryNames)
            for j=1:Mobj.nObcNodes
                % Get the current location (from the node ID)
                currLon = Mobj.lon(Mobj.obc_nodes(i,j));
                currLat = Mobj.lat(Mobj.obc_nodes(i,j));
                %if ftbverbose
                    fprintf('Position %i of %i (%.3f %.3f)... \n', j, Mobj.nObcNodes, currLon, currLat);
                %end
                [surfaceElevation(j,:,i), ~] = tmd_tide_pred(inputConf.Model, ...
                    inputConf.tidesMJD+678942.000000, currLat, currLon, 'z', tIndUse);
                if isnan(surfaceElevation(j,:))
                    % Try the global model instead.
                    [surfaceElevation(j,:,i), ~] = tmd_tide_pred(inputConf.Model, ...
                    inputConf.tidesMJD, currLat, currLon, 'z', tIndUse);
                end
            end
        end
        Mobj.surfaceElevation = surfaceElevation;
        % Tidy up some more
        clear i j tIndUse obc_lat obc_lon currLon currLat surfaceElevation
        cd(here);
        save([inputConf.outbase,'varb/Mobj_01.mat'],'Mobj','-v7.3','-nocompression');
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        % TEST CODE
        % t.Model = '/home/usr0/n70110d/github/fvcomtoolbox/tmd/DATA/Model_OhS'
        % t.SDtime = [datenum([2019,05,14,15,00,00]):1/24/60*5:datenum([2019,05,14,15,00,00])+1]
        % t.lat = 35.5681
        % t.lon = 140.0456
        % t.ptype = 'z'
        % t.Cid = 
        % [t.TS,t.conList]=tmd_tide_pred(t.Model,t.SDtime,t.lat,t.lon,t.ptype)
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    end
elseif strcmpi(inputConf.obcForcing, 'otps')
    if develop_mode == 3
    	fprintf('Loading Model objet file...\n');
        load([inputConf.outbase,'varb/Mobj_01.mat']);
        fprintf('Done!\n');
    else
        surfaceElevation = nan(Mobj.nObcNodes, size(inputConf.tidesMJD, 2), length(inputConf.boundaryNames));
        for i=1:length(inputConf.boundaryNames)
            for j=1:Mobj.nObcNodes
                % Get variables from the generated mat format files
                filename = [tpxo_dir,'OUT/1st_',mat2str(j),'.mat'];
                fprintf('Getting %s from TMD\n',['1st_',mat2str(j),'.mat']);
                variable = {'SerialDay','TimeSeries'};
                load(filename,variable{:});
                [~,n] = find(SerialDay - 678942 == inputConf.tidesMJD(1));
                for k=1:length(inputConf.tidesMJD)
                    surfaceElevation(j,k,i) = TimeSeries(1,n+k-1);
                end
            end
        end
        Mobj.surfaceElevation = surfaceElevation;
        % Tidy up some more
        clear i j k m n filename variable TimeSeries SerialDay surfaceElevation
        save([inputConf.outbase,'varb/Mobj_01.mat'],'Mobj','-v7.3','-nocompression');
    end
elseif strcmpi(inputConf.obcForcing,'phase-amp')
    if develop_mode == 3
        cd(here);
    	fprintf('Loading Model objet file...\n');
        load([inputConf.outbase,'varb/Mobj_01.mat']);
        fprintf('Done!\n');
    else
        % Boundary conditions from TPXO (for spectral tides or predicted
        % surface elevations)
        % Put the input list into the mesh object.
        Mobj.Components = inputConf.tidalComponents;
        % Set up the tidal struct. This contains the relevant information for up to
        % eight constituents, ordered as period, beta love number and equilibrium
        % amplitude.
        %                    period    beta    eq. amp.
        %                      (s)      (?)       (m)
        tideComponents.M2 = [44714.16, 0.693, 0.242334];
        tideComponents.S2 = [43200.00, 0.693, 0.112841];
        tideComponents.N2 = [45570.24, 0.693, 0.046398];
        tideComponents.K2 = [43082.28, 0.693, 0.030704];
        tideComponents.K1 = [86163.84, 0.736, 0.141565];
        tideComponents.O1 = [92949.84, 0.695, 0.100514];
        tideComponents.P1 = [86637.24, 0.706, 0.046843];
        tideComponents.Q1 = [96726.24, 0.695, 0.019256];
        %tideComponents.Mf = [1180260,  ?????, 0.041742];
        %tideComponents.Mm = [2380716,  ?????, 0.022026];
        %tideComponents.Ssa = [15778980, ????, 0.019446];
        % Extract the values for each tidal component into Mobj.period_obc,
        % Mobj.beta_love and Mobj.equilibrium_amp.
        for c=1:size(Mobj.Components,2)
            Mobj.period_obc(c) = tideComponents.(Mobj.Components{c})(1);
            Mobj.beta_love(c) = tideComponents.(Mobj.Components{c})(2);
            Mobj.equilibrium_amp(c) = tideComponents.(Mobj.Components{c})(3);
        end
        clear c
        % Provide amplitude and phase data for the boundary nodes. Use the TMD
        % function tmd_extract_HC.m to get harmonic constants at the boundary
        % nodes.
        amp=cell(1,Mobj.nObs);
        Gph=cell(1,Mobj.nObs);
        Depth=cell(1,Mobj.nObs);
        constList=cell(1,Mobj.nObs);
        for i=1:length(inputConf.boundaryNames)
            % It is possible to specify the indices of the constituents of interest
            % when calling tmd_extract_HC, but it requires knowing the order
            % they're stored in the file. Easier for me to extract the constituents
            % of interest separately. This makes it a bit slower (having to
            % interpolate all the constituents is slower than a select few), but
            % it's a bit easier to code up.
            if Mobj.have_lonlat
            [amp{i},Gph{i},Depth{i},constList{i}] = tmd_extract_HC(inputConf.Model,Mobj.lat(Mobj.read_obc_nodes{i}),Mobj.lon(Mobj.read_obc_nodes{i}),inputConf.extractType);
            else
                % Need to convert XY to latlon.
                try % to use the handy file exchange utm2deg function
                    % Make cell array of all the zones because utm2deg is a bit
                    % inflexible in that regard (size of utmZones must equal size
                    % of x and y).
                    % This is somewhat redundant now that the lat/long is added
                    % when generating the Coriolis values, but it's still
                    % worthwhile keeping it here just in case. No harm should
                    % come of it being here anyway.
                    utmZones=cellfun(@(x) repmat(x,length(Mobj.x(Mobj.read_obc_nodes{i})),1),inputConf.utmZone,'uni',false);
                    [tmpLat,tmpLon] = utm2deg(Mobj.x(Mobj.read_obc_nodes{i}),Mobj.y(Mobj.read_obc_nodes{i}),utmZones{1});
                    % Get the tidal data
                    [amp{i},Gph{i},Depth{i},constList{i}] = tmd_extract_HC(inputConf.Model,tmpLat,tmpLon,inputConf.extractType);
                catch %#ok<CTCH>
                    error('Can''t convert X/Y positions to lat/long, so can''t extract data from the TPXO data. Consider adding utm2deg to your PATH.')
                end
            end
            for j=1:numel(Mobj.Components)
                fprintf('Extracting %s... ',Mobj.Components{j});
                posIdx = strmatch(lower(Mobj.Components{j}),constList{i}); %#ok<MATCH2>
                Mobj.amp_obc{i}(j,:) = amp{i}(posIdx,:);
                Mobj.phase_obc{i}(j,:) = Gph{i}(posIdx,:); % Greenwich phase
                fprintf('done!\n');
            end
        end
        clear posIdx amp Gph Depth constList
        % Find NaNs in the boundaries
        for i=1:Mobj.nObs
            brokenBoundary=i;
            nanIdx = Mobj.read_obc_nodes{brokenBoundary}(isnan(Mobj.phase_obc{brokenBoundary}(1,:)));
            nanLon = Mobj.lon(nanIdx);
            nanLat = Mobj.lat(nanIdx);
            inputConf.doFig=0;
            if max(nanLon)-min(nanLon)==0
                minPos = min(nanLat);
                maxPos = max(nanLat);
                inputConf.doFig=1;
            elseif max(nanLat)-min(nanLat)==0
                minPos = min(nanLon);
                maxPos = max(nanLon);
                inputConf.doFig=1;
            elseif isempty(nanIdx)
                fprintf('No NaNs in %s boundary.\n',inputConf.boundaryNames{i});
                clear nanLon nanLat nanIdx
            else
                error('Boundaries are not linear. Won''t plot %s boundary NaNs',inputConf.boundaryNames{i});
            end
            if inputConf.doFig
                figure
                patch('Vertices',[Mobj.lon,Mobj.lat],'Faces',Mobj.tri,...
                    'Cdata',Mobj.h,'edgecolor','k','facecolor','interp');
                hold on;
                plot(Mobj.lon(nanIdx),Mobj.lat(nanIdx),'wo','LineWidth',3,'MarkerSize',12);
                plot(Mobj.lon(nanIdx),Mobj.lat(nanIdx),'ko','LineWidth',3,'MarkerSize',8);
                axis('equal','tight');
            end
        end
        save([inputConf.outbase,'varb/Mobj_01.mat'],'Mobj','-v7.3','-nocompression');
    end
end
Position 1 of 36 (140.376 35.119)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 2 of 36 (140.371 35.102)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 3 of 36 (140.365 35.089)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 4 of 36 (140.360 35.076)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 5 of 36 (140.355 35.062)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 6 of 36 (140.347 35.047)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 7 of 36 (140.337 35.028)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 8 of 36 (140.304 34.979)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 9 of 36 (140.290 34.963)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 10 of 36 (140.258 34.929)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 11 of 36 (140.207 34.885)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 12 of 36 (140.160 34.853)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 13 of 36 (140.114 34.826)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 14 of 36 (140.062 34.803)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 15 of 36 (140.020 34.787)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 16 of 36 (139.975 34.773)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 17 of 36 (139.936 34.764)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 18 of 36 (139.902 34.757)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 19 of 36 (139.863 34.752)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 20 of 36 (139.824 34.748)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 21 of 36 (139.785 34.746)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 22 of 36 (139.750 34.746)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 23 of 36 (139.715 34.747)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 24 of 36 (139.663 34.753)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 25 of 36 (139.619 34.760)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 26 of 36 (139.564 34.772)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 27 of 36 (139.506 34.790)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 28 of 36 (139.478 34.801)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 29 of 36 (139.448 34.814)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 30 of 36 (139.417 34.829)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 31 of 36 (139.387 34.845)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 32 of 36 (139.341 34.875)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 33 of 36 (139.302 34.906)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 34 of 36 (139.264 34.942)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 35 of 36 (139.231 34.980)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
Position 36 of 36 (139.209 35.011)... 
MODE: Time series
Reading /Users/yulong/GitHub/TMD/DATA/hf.OhS2010.out and extracting HC...
Interpolating constituent m2  ... done
Interpolating constituent s2  ... done
Interpolating constituent n2  ... done
Interpolating constituent k2  ... done
Interpolating constituent k1  ... done
Interpolating constituent o1  ... done
Interpolating constituent p1  ... done
Interpolating constituent q1  ... done
Done extracting HC
Predicting tide ...
done
clear tpxo_dir;

if strcmpi(inputConf.obcForcing, 'z')
    % Write out the TPXO predicted surface elevation.
    write_FVCOM_elevtide(Mobj, ...
        inputConf.tidesMJD,...
        fullfile(inputConf.outbase, [inputConf.casename, '_julian_obc.nc']),...
        'Model surface elevation boundary input',...
        'floattime', true,...
        'julian', true);
elseif strcmpi(inputConf.obcForcing, 'otps')
    % Write out the TPXO predicted surface elevation.
    write_FVCOM_elevtide(Mobj, ...
        inputConf.tidesMJD,...
        fullfile(inputConf.outbase, [inputConf.casename, '_julian_obc.nc']),...
        'Model surface elevation boundary input',...
        'floattime', true,...
        'julian', true);
elseif strcmpi(inputConf.obcForcing,'phase-amp')  
    % Write out the TPXO predicted spectral tide.
    set_spectide(Mobj,...
        numel(Mobj.Components),...
        fullfile(inputConf.outbase,[inputConf.casename,'_non_julian_obc.nc']),...
        'TPXO spectral tidal boundary input');
end
fprintf('Tidal forcing working time: %.2f minutes\n', toc / 60);
Tidal forcing working time: 1.40 minutes

%%
%%%------------------------------------------------------------------------
%%%                    HYCOM S&T forcing and staff
%%%------------------------------------------------------------------------
tic
% Now we need some boundary temperature and salinity conditions.
if strcmpi('HYCOM', {inputConf.obc_temp, inputConf.obc_salt})
    % Use HYCOM data for the boundary forcing.
    % Offset the times to give us a bit of wiggle room.
    if develop_mode == 3
    	fprintf('Loading Model objet file...\n')
        load([inputConf.outbase,'varb/Mobj_02.mat']);
        fprintf('Done!\n');
    else
    	if develop_mode == 1
            % modelTime = inputConf.obctsMJD;varlist={'temperature', 'salinity'}
    		fprintf('Downloading daliy open boundary S&T forcing from HYCOM...\n');
            % T
            for i = 1:10
                try
                    hycom_t = get_HYCOM_forcing(Mobj, inputConf.obctsMJD, {'temperature'}); 
                    break;  % Break out of the i-loop on success
                catch ME
                    disp(ME);
                    fprintf('Retrying...\n');
                end
            end
            save(['hycom_t','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat'],...
                'hycom_t','-v7.3','-nocompression');
            % S
            for i = 1:10
                try
                    hycom_s = get_HYCOM_forcing(Mobj, inputConf.obctsMJD, {'salinity'}); 
                    break;  % Break out of the i-loop on success
                catch ME
                    disp(ME);
                    fprintf('Retrying...\n');
                end
            end
            save(['hycom_s','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat'],...
                'hycom_s','-v7.3','-nocompression');
            fprintf('Downloading daliy open boundary meanflow from HYCOM...\n');
            if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
                fprintf('Writing daliy open boundary meanflow file.\n')
                % u
                for i = 1:10
                    try
                        hycom_u = get_HYCOM_forcing(Mobj, inputConf.obctsMJD, {'u'}); 
                        break;  % Break out of the i-loop on success
                    catch ME
                        disp(ME);
                        fprintf('Retrying...\n');
                    end
                end
                save(['hycom_u','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat'],...
                    'hycom_u','-v7.3','-nocompression');
                % v
                for i = 1:10
                    try
                        hycom_v = get_HYCOM_forcing(Mobj, inputConf.obctsMJD, {'v'}); 
                        break;  % Break out of the i-loop on success
                    catch ME
                        disp(ME);
                        fprintf('Retrying...\n');
                    end
                end
                save(['hycom_v','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat'],...
                    'hycom_v','-v7.3','-nocompression');
            end
            fprintf('Downloading daliy open boundary S&T forcing from HYCOM...Done!\n');
        elseif develop_mode == 2
    		fprintf('Loading daliy open boundary S&T forcing from local HYCOM database...\n')
        	load(['hycom_t','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat']);
        	load(['hycom_s','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat']);
            fprintf('Downloading daliy open boundary S&T forcing from HYCOM...Done!\n');
            if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
                load(['hycom_u','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat']);
                load(['hycom_v','_',num2str(inputConf.startDate(1)),'_',num2str(inputConf.endDate(1)),'.mat']);
            end
    	end
    	% Interpolate the 4D HYCOM data on the FVCOM vertical grid at the open boundaries.
    	Mobj = get_HYCOM_tsobc(Mobj, hycom_t, {'temperature'});
    	Mobj = get_HYCOM_tsobc(Mobj, hycom_s, {'salinity'});
        if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
            % finding nesting region shows a nand of elements,
            % that is not we wanted, we need obc faces, instead.
            % Nested = find_nesting_region(inputConf, Mobj);
            % Mobj.read_obc_elems = Nested.read_obc_elems;
            Mobj = find_boundary_elements(Mobj);
            Mobj = get_HYCOM_tsobc(Mobj, hycom_u, {'u'});
            Mobj = get_HYCOM_tsobc(Mobj, hycom_v, {'v'});
        end
        clear hycom_*
        % backup daliy data
        Mobj.backup_temp = Mobj.temperature; 
        Mobj.backup_salt = Mobj.salt;
        Mobj.backup_tstm = Mobj.ts_times;
        if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
            Mobj.backup_mflu = Mobj.u;
            Mobj.backup_mflv = Mobj.v;
            Mobj.backup_mftm = Mobj.mf_times;
        end
        % recover daliy data
        %{
        Mobj.temperature = Mobj.backup_temp; Mobj.salt = Mobj.backup_salt;
        Mobj.u = Mobj.backup_mflu;           Mobj.v = Mobj.backup_mflv;
        Mobj.ts_times = Mobj.backup_tstm;    Mobj.mf_times = Mobj.backup_mftm;
        %}
        % Interpolate the 4D HYCOM data on the hourly time series
        Mobj = get_HYCOM_series(Mobj, inputConf.dateobs, 'temperature',true);
        Mobj = get_HYCOM_series(Mobj, inputConf.dateobs, 'salinity',true);
        if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
            Mobj = get_HYCOM_series(Mobj, inputConf.dateobs, 'u',true);
            Mobj = get_HYCOM_series(Mobj, inputConf.dateobs, 'v',true);
            % Generate boundary mean flow values at the centroids of the open boundary elements. 
            % For the various output files, we need both u and v as well as depth averaged velocity 
            % at each boundary node position. 
            % An example: get_POLCOMS_meanflow uses PML POLCOMS-ERSEM NetCDF files 
            % to interpolate mean flow to the FVCOM open boundary elements and vertical grid. 
            % The velocity data should be saved in Mobj.velocity of size [nElements, nTime] 
            % and the u and v components in Mobj.meanflow_u and Mobj.meanflow_v as arrays 
            % of size [nElements, nSiglay, nTime].
            % Mobj.meanflow = zeros(numel(Mobj.read_obc_elements{1}), numel(Mobj.mf_times));
            % Stick the values in the mesh structure.
            Mobj.meanflow_u = Mobj.u;
            Mobj.meanflow_v = Mobj.v;
            % Now we have the 3D arrays, create depth averaged velocities too
            Mobj.meanflow_ubar = squeeze(mean(Mobj.meanflow_u, 2));
            Mobj.meanflow_vbar = squeeze(mean(Mobj.meanflow_v, 2));
            % Depth averaged velocity
            Mobj.velocity = squeeze(mean(sqrt(Mobj.meanflow_u.^2 + Mobj.meanflow_v.^2), 2));
        end
        save([inputConf.outbase,'varb/Mobj_02.mat'],'Mobj','-v7.3','-nocompression');
    end
elseif strcmpi('FRA-JCOPE', {inputConf.obc_temp, inputConf.obc_salt})
    % [data,header]=read_grads(file_name,var_name,varargin)
    % 
    % file_name = ['C:\Users\Yulong WANG\Documents\GitHub\jcope-convert\fra_jcope\el.ctl'];
    % var_name = ['all'];
    % [data,header]=read_grads('C:\Users\Yulong WANG\Documents\GitHub\jcope-convert\fra_jcope\t.ctl','all'); 
end
Loading daliy open boundary S&T forcing from local HYCOM database...
Downloading daliy open boundary S&T forcing from HYCOM...Done!

begin : interp_coarse_to_obc
Variable temperature on nodes (36 positions)
interp_coarse_to_obc : 1 of 732 temperature timesteps... 
Starting parallel pool (parpool) using the 'local' profile ...
Connected to the parallel pool (number of workers: 2).
interp_coarse_to_obc : 2 of 732 temperature timesteps... 
interp_coarse_to_obc : 3 of 732 temperature timesteps... 
interp_coarse_to_obc : 4 of 732 temperature timesteps... 
interp_coarse_to_obc : 5 of 732 temperature timesteps... 
interp_coarse_to_obc : 6 of 732 temperature timesteps... 
interp_coarse_to_obc : 7 of 732 temperature timesteps... 
interp_coarse_to_obc : 8 of 732 temperature timesteps... 
interp_coarse_to_obc : 9 of 732 temperature timesteps... 
interp_coarse_to_obc : 10 of 732 temperature timesteps... 
interp_coarse_to_obc : 11 of 732 temperature timesteps... 
interp_coarse_to_obc : 12 of 732 temperature timesteps... 
interp_coarse_to_obc : 13 of 732 temperature timesteps... 
interp_coarse_to_obc : 14 of 732 temperature timesteps... 
interp_coarse_to_obc : 15 of 732 temperature timesteps... 
interp_coarse_to_obc : 16 of 732 temperature timesteps... 
interp_coarse_to_obc : 17 of 732 temperature timesteps... 
interp_coarse_to_obc : 18 of 732 temperature timesteps... 
interp_coarse_to_obc : 19 of 732 temperature timesteps... 
interp_coarse_to_obc : 20 of 732 temperature timesteps... 
interp_coarse_to_obc : 21 of 732 temperature timesteps... 
interp_coarse_to_obc : 22 of 732 temperature timesteps... 
interp_coarse_to_obc : 23 of 732 temperature timesteps... 
interp_coarse_to_obc : 24 of 732 temperature timesteps... 
interp_coarse_to_obc : 25 of 732 temperature timesteps... 
interp_coarse_to_obc : 26 of 732 temperature timesteps... 
interp_coarse_to_obc : 27 of 732 temperature timesteps... 
interp_coarse_to_obc : 28 of 732 temperature timesteps... 
interp_coarse_to_obc : 29 of 732 temperature timesteps... 
interp_coarse_to_obc : 30 of 732 temperature timesteps... 
interp_coarse_to_obc : 31 of 732 temperature timesteps... 
interp_coarse_to_obc : 32 of 732 temperature timesteps... 
interp_coarse_to_obc : 33 of 732 temperature timesteps... 
interp_coarse_to_obc : 34 of 732 temperature timesteps... 
interp_coarse_to_obc : 35 of 732 temperature timesteps... 
interp_coarse_to_obc : 36 of 732 temperature timesteps... 
interp_coarse_to_obc : 37 of 732 temperature timesteps... 
interp_coarse_to_obc : 38 of 732 temperature timesteps... 
interp_coarse_to_obc : 39 of 732 temperature timesteps... 
interp_coarse_to_obc : 40 of 732 temperature timesteps... 
interp_coarse_to_obc : 41 of 732 temperature timesteps... 
interp_coarse_to_obc : 42 of 732 temperature timesteps... 
interp_coarse_to_obc : 43 of 732 temperature timesteps... 
interp_coarse_to_obc : 44 of 732 temperature timesteps... 
interp_coarse_to_obc : 45 of 732 temperature timesteps... 
interp_coarse_to_obc : 46 of 732 temperature timesteps... 
interp_coarse_to_obc : 47 of 732 temperature timesteps... 
interp_coarse_to_obc : 48 of 732 temperature timesteps... 
interp_coarse_to_obc : 49 of 732 temperature timesteps... 
interp_coarse_to_obc : 50 of 732 temperature timesteps... 
interp_coarse_to_obc : 51 of 732 temperature timesteps... 
interp_coarse_to_obc : 52 of 732 temperature timesteps... 
interp_coarse_to_obc : 53 of 732 temperature timesteps... 
interp_coarse_to_obc : 54 of 732 temperature timesteps... 
interp_coarse_to_obc : 55 of 732 temperature timesteps... 
interp_coarse_to_obc : 56 of 732 temperature timesteps... 
interp_coarse_to_obc : 57 of 732 temperature timesteps... 
interp_coarse_to_obc : 58 of 732 temperature timesteps... 
interp_coarse_to_obc : 59 of 732 temperature timesteps... 
interp_coarse_to_obc : 60 of 732 temperature timesteps... 
interp_coarse_to_obc : 61 of 732 temperature timesteps... 
interp_coarse_to_obc : 62 of 732 temperature timesteps... 
interp_coarse_to_obc : 63 of 732 temperature timesteps... 
interp_coarse_to_obc : 64 of 732 temperature timesteps... 
interp_coarse_to_obc : 65 of 732 temperature timesteps... 
interp_coarse_to_obc : 66 of 732 temperature timesteps... 
interp_coarse_to_obc : 67 of 732 temperature timesteps... 
interp_coarse_to_obc : 68 of 732 temperature timesteps... 
interp_coarse_to_obc : 69 of 732 temperature timesteps... 
interp_coarse_to_obc : 70 of 732 temperature timesteps... 
interp_coarse_to_obc : 71 of 732 temperature timesteps... 
interp_coarse_to_obc : 72 of 732 temperature timesteps... 
interp_coarse_to_obc : 73 of 732 temperature timesteps... 
interp_coarse_to_obc : 74 of 732 temperature timesteps... 
interp_coarse_to_obc : 75 of 732 temperature timesteps... 
interp_coarse_to_obc : 76 of 732 temperature timesteps... 
interp_coarse_to_obc : 77 of 732 temperature timesteps... 
interp_coarse_to_obc : 78 of 732 temperature timesteps... 
interp_coarse_to_obc : 79 of 732 temperature timesteps... 
interp_coarse_to_obc : 80 of 732 temperature timesteps... 
interp_coarse_to_obc : 81 of 732 temperature timesteps... 
interp_coarse_to_obc : 82 of 732 temperature timesteps... 
interp_coarse_to_obc : 83 of 732 temperature timesteps... 
interp_coarse_to_obc : 84 of 732 temperature timesteps... 
interp_coarse_to_obc : 85 of 732 temperature timesteps... 
interp_coarse_to_obc : 86 of 732 temperature timesteps... 
interp_coarse_to_obc : 87 of 732 temperature timesteps... 
interp_coarse_to_obc : 88 of 732 temperature timesteps... 
interp_coarse_to_obc : 89 of 732 temperature timesteps... 
interp_coarse_to_obc : 90 of 732 temperature timesteps... 
interp_coarse_to_obc : 91 of 732 temperature timesteps... 
interp_coarse_to_obc : 92 of 732 temperature timesteps... 
interp_coarse_to_obc : 93 of 732 temperature timesteps... 
interp_coarse_to_obc : 94 of 732 temperature timesteps... 
interp_coarse_to_obc : 95 of 732 temperature timesteps... 
interp_coarse_to_obc : 96 of 732 temperature timesteps... 
interp_coarse_to_obc : 97 of 732 temperature timesteps... 
interp_coarse_to_obc : 98 of 732 temperature timesteps... 
interp_coarse_to_obc : 99 of 732 temperature timesteps... 
interp_coarse_to_obc : 100 of 732 temperature timesteps... 
interp_coarse_to_obc : 101 of 732 temperature timesteps... 
interp_coarse_to_obc : 102 of 732 temperature timesteps... 
interp_coarse_to_obc : 103 of 732 temperature timesteps... 
interp_coarse_to_obc : 104 of 732 temperature timesteps... 
interp_coarse_to_obc : 105 of 732 temperature timesteps... 
interp_coarse_to_obc : 106 of 732 temperature timesteps... 
interp_coarse_to_obc : 107 of 732 temperature timesteps... 
interp_coarse_to_obc : 108 of 732 temperature timesteps... 
interp_coarse_to_obc : 109 of 732 temperature timesteps... 
interp_coarse_to_obc : 110 of 732 temperature timesteps... 
interp_coarse_to_obc : 111 of 732 temperature timesteps... 
interp_coarse_to_obc : 112 of 732 temperature timesteps... 
interp_coarse_to_obc : 113 of 732 temperature timesteps... 
interp_coarse_to_obc : 114 of 732 temperature timesteps... 
interp_coarse_to_obc : 115 of 732 temperature timesteps... 
interp_coarse_to_obc : 116 of 732 temperature timesteps... 
interp_coarse_to_obc : 117 of 732 temperature timesteps... 
interp_coarse_to_obc : 118 of 732 temperature timesteps... 
interp_coarse_to_obc : 119 of 732 temperature timesteps... 
interp_coarse_to_obc : 120 of 732 temperature timesteps... 
interp_coarse_to_obc : 121 of 732 temperature timesteps... 
interp_coarse_to_obc : 122 of 732 temperature timesteps... 
interp_coarse_to_obc : 123 of 732 temperature timesteps... 
interp_coarse_to_obc : 124 of 732 temperature timesteps... 
interp_coarse_to_obc : 125 of 732 temperature timesteps... 
interp_coarse_to_obc : 126 of 732 temperature timesteps... 
interp_coarse_to_obc : 127 of 732 temperature timesteps... 
interp_coarse_to_obc : 128 of 732 temperature timesteps... 
interp_coarse_to_obc : 129 of 732 temperature timesteps... 
interp_coarse_to_obc : 130 of 732 temperature timesteps... 
interp_coarse_to_obc : 131 of 732 temperature timesteps... 
interp_coarse_to_obc : 132 of 732 temperature timesteps... 
interp_coarse_to_obc : 133 of 732 temperature timesteps... 
interp_coarse_to_obc : 134 of 732 temperature timesteps... 
interp_coarse_to_obc : 135 of 732 temperature timesteps... 
interp_coarse_to_obc : 136 of 732 temperature timesteps... 
interp_coarse_to_obc : 137 of 732 temperature timesteps... 
interp_coarse_to_obc : 138 of 732 temperature timesteps... 
interp_coarse_to_obc : 139 of 732 temperature timesteps... 
interp_coarse_to_obc : 140 of 732 temperature timesteps... 
interp_coarse_to_obc : 141 of 732 temperature timesteps... 
interp_coarse_to_obc : 142 of 732 temperature timesteps... 
interp_coarse_to_obc : 143 of 732 temperature timesteps... 
interp_coarse_to_obc : 144 of 732 temperature timesteps... 
interp_coarse_to_obc : 145 of 732 temperature timesteps... 
interp_coarse_to_obc : 146 of 732 temperature timesteps... 
interp_coarse_to_obc : 147 of 732 temperature timesteps... 
interp_coarse_to_obc : 148 of 732 temperature timesteps... 
interp_coarse_to_obc : 149 of 732 temperature timesteps... 
interp_coarse_to_obc : 150 of 732 temperature timesteps... 
interp_coarse_to_obc : 151 of 732 temperature timesteps... 
interp_coarse_to_obc : 152 of 732 temperature timesteps... 
interp_coarse_to_obc : 153 of 732 temperature timesteps... 
interp_coarse_to_obc : 154 of 732 temperature timesteps... 
interp_coarse_to_obc : 155 of 732 temperature timesteps... 
interp_coarse_to_obc : 156 of 732 temperature timesteps... 
interp_coarse_to_obc : 157 of 732 temperature timesteps... 
interp_coarse_to_obc : 158 of 732 temperature timesteps... 
interp_coarse_to_obc : 159 of 732 temperature timesteps... 
interp_coarse_to_obc : 160 of 732 temperature timesteps... 
interp_coarse_to_obc : 161 of 732 temperature timesteps... 
interp_coarse_to_obc : 162 of 732 temperature timesteps... 
interp_coarse_to_obc : 163 of 732 temperature timesteps... 
interp_coarse_to_obc : 164 of 732 temperature timesteps... 
interp_coarse_to_obc : 165 of 732 temperature timesteps... 
interp_coarse_to_obc : 166 of 732 temperature timesteps... 
interp_coarse_to_obc : 167 of 732 temperature timesteps... 
interp_coarse_to_obc : 168 of 732 temperature timesteps... 
interp_coarse_to_obc : 169 of 732 temperature timesteps... 
interp_coarse_to_obc : 170 of 732 temperature timesteps... 
interp_coarse_to_obc : 171 of 732 temperature timesteps... 
interp_coarse_to_obc : 172 of 732 temperature timesteps... 
interp_coarse_to_obc : 173 of 732 temperature timesteps... 
interp_coarse_to_obc : 174 of 732 temperature timesteps... 
interp_coarse_to_obc : 175 of 732 temperature timesteps... 
interp_coarse_to_obc : 176 of 732 temperature timesteps... 
interp_coarse_to_obc : 177 of 732 temperature timesteps... 
interp_coarse_to_obc : 178 of 732 temperature timesteps... 
interp_coarse_to_obc : 179 of 732 temperature timesteps... 
interp_coarse_to_obc : 180 of 732 temperature timesteps... 
interp_coarse_to_obc : 181 of 732 temperature timesteps... 
interp_coarse_to_obc : 182 of 732 temperature timesteps... 
interp_coarse_to_obc : 183 of 732 temperature timesteps... 
interp_coarse_to_obc : 184 of 732 temperature timesteps... 
interp_coarse_to_obc : 185 of 732 temperature timesteps... 
interp_coarse_to_obc : 186 of 732 temperature timesteps... 
interp_coarse_to_obc : 187 of 732 temperature timesteps... 
interp_coarse_to_obc : 188 of 732 temperature timesteps... 
interp_coarse_to_obc : 189 of 732 temperature timesteps... 
interp_coarse_to_obc : 190 of 732 temperature timesteps... 
interp_coarse_to_obc : 191 of 732 temperature timesteps... 
interp_coarse_to_obc : 192 of 732 temperature timesteps... 
interp_coarse_to_obc : 193 of 732 temperature timesteps... 
interp_coarse_to_obc : 194 of 732 temperature timesteps... 
interp_coarse_to_obc : 195 of 732 temperature timesteps... 
interp_coarse_to_obc : 196 of 732 temperature timesteps... 
interp_coarse_to_obc : 197 of 732 temperature timesteps... 
interp_coarse_to_obc : 198 of 732 temperature timesteps... 
interp_coarse_to_obc : 199 of 732 temperature timesteps... 
interp_coarse_to_obc : 200 of 732 temperature timesteps... 
interp_coarse_to_obc : 201 of 732 temperature timesteps... 
interp_coarse_to_obc : 202 of 732 temperature timesteps... 
interp_coarse_to_obc : 203 of 732 temperature timesteps... 
interp_coarse_to_obc : 204 of 732 temperature timesteps... 
interp_coarse_to_obc : 205 of 732 temperature timesteps... 
interp_coarse_to_obc : 206 of 732 temperature timesteps... 
interp_coarse_to_obc : 207 of 732 temperature timesteps... 
interp_coarse_to_obc : 208 of 732 temperature timesteps... 
interp_coarse_to_obc : 209 of 732 temperature timesteps... 
interp_coarse_to_obc : 210 of 732 temperature timesteps... 
interp_coarse_to_obc : 211 of 732 temperature timesteps... 
interp_coarse_to_obc : 212 of 732 temperature timesteps... 
interp_coarse_to_obc : 213 of 732 temperature timesteps... 
interp_coarse_to_obc : 214 of 732 temperature timesteps... 
interp_coarse_to_obc : 215 of 732 temperature timesteps... 
interp_coarse_to_obc : 216 of 732 temperature timesteps... 
interp_coarse_to_obc : 217 of 732 temperature timesteps... 
interp_coarse_to_obc : 218 of 732 temperature timesteps... 
interp_coarse_to_obc : 219 of 732 temperature timesteps... 
interp_coarse_to_obc : 220 of 732 temperature timesteps... 
interp_coarse_to_obc : 221 of 732 temperature timesteps... 
interp_coarse_to_obc : 222 of 732 temperature timesteps... 
interp_coarse_to_obc : 223 of 732 temperature timesteps... 
interp_coarse_to_obc : 224 of 732 temperature timesteps... 
interp_coarse_to_obc : 225 of 732 temperature timesteps... 
interp_coarse_to_obc : 226 of 732 temperature timesteps... 
interp_coarse_to_obc : 227 of 732 temperature timesteps... 
interp_coarse_to_obc : 228 of 732 temperature timesteps... 
interp_coarse_to_obc : 229 of 732 temperature timesteps... 
interp_coarse_to_obc : 230 of 732 temperature timesteps... 
interp_coarse_to_obc : 231 of 732 temperature timesteps... 
interp_coarse_to_obc : 232 of 732 temperature timesteps... 
interp_coarse_to_obc : 233 of 732 temperature timesteps... 
interp_coarse_to_obc : 234 of 732 temperature timesteps... 
interp_coarse_to_obc : 235 of 732 temperature timesteps... 
interp_coarse_to_obc : 236 of 732 temperature timesteps... 
interp_coarse_to_obc : 237 of 732 temperature timesteps... 
interp_coarse_to_obc : 238 of 732 temperature timesteps... 
interp_coarse_to_obc : 239 of 732 temperature timesteps... 
interp_coarse_to_obc : 240 of 732 temperature timesteps... 
interp_coarse_to_obc : 241 of 732 temperature timesteps... 
interp_coarse_to_obc : 242 of 732 temperature timesteps... 
interp_coarse_to_obc : 243 of 732 temperature timesteps... 
interp_coarse_to_obc : 244 of 732 temperature timesteps... 
interp_coarse_to_obc : 245 of 732 temperature timesteps... 
interp_coarse_to_obc : 246 of 732 temperature timesteps... 
interp_coarse_to_obc : 247 of 732 temperature timesteps... 
interp_coarse_to_obc : 248 of 732 temperature timesteps... 
interp_coarse_to_obc : 249 of 732 temperature timesteps... 
interp_coarse_to_obc : 250 of 732 temperature timesteps... 
interp_coarse_to_obc : 251 of 732 temperature timesteps... 
interp_coarse_to_obc : 252 of 732 temperature timesteps... 
interp_coarse_to_obc : 253 of 732 temperature timesteps... 
interp_coarse_to_obc : 254 of 732 temperature timesteps... 
interp_coarse_to_obc : 255 of 732 temperature timesteps... 
interp_coarse_to_obc : 256 of 732 temperature timesteps... 
interp_coarse_to_obc : 257 of 732 temperature timesteps... 
interp_coarse_to_obc : 258 of 732 temperature timesteps... 
interp_coarse_to_obc : 259 of 732 temperature timesteps... 
interp_coarse_to_obc : 260 of 732 temperature timesteps... 
interp_coarse_to_obc : 261 of 732 temperature timesteps... 
interp_coarse_to_obc : 262 of 732 temperature timesteps... 
interp_coarse_to_obc : 263 of 732 temperature timesteps... 
interp_coarse_to_obc : 264 of 732 temperature timesteps... 
interp_coarse_to_obc : 265 of 732 temperature timesteps... 
interp_coarse_to_obc : 266 of 732 temperature timesteps... 
interp_coarse_to_obc : 267 of 732 temperature timesteps... 
interp_coarse_to_obc : 268 of 732 temperature timesteps... 
interp_coarse_to_obc : 269 of 732 temperature timesteps... 
interp_coarse_to_obc : 270 of 732 temperature timesteps... 
interp_coarse_to_obc : 271 of 732 temperature timesteps... 
interp_coarse_to_obc : 272 of 732 temperature timesteps... 
interp_coarse_to_obc : 273 of 732 temperature timesteps... 
interp_coarse_to_obc : 274 of 732 temperature timesteps... 
interp_coarse_to_obc : 275 of 732 temperature timesteps... 
interp_coarse_to_obc : 276 of 732 temperature timesteps... 
interp_coarse_to_obc : 277 of 732 temperature timesteps... 
interp_coarse_to_obc : 278 of 732 temperature timesteps... 
interp_coarse_to_obc : 279 of 732 temperature timesteps... 
interp_coarse_to_obc : 280 of 732 temperature timesteps... 
interp_coarse_to_obc : 281 of 732 temperature timesteps... 
interp_coarse_to_obc : 282 of 732 temperature timesteps... 
interp_coarse_to_obc : 283 of 732 temperature timesteps... 
interp_coarse_to_obc : 284 of 732 temperature timesteps... 
interp_coarse_to_obc : 285 of 732 temperature timesteps... 
interp_coarse_to_obc : 286 of 732 temperature timesteps... 
interp_coarse_to_obc : 287 of 732 temperature timesteps... 
interp_coarse_to_obc : 288 of 732 temperature timesteps... 
interp_coarse_to_obc : 289 of 732 temperature timesteps... 
interp_coarse_to_obc : 290 of 732 temperature timesteps... 
interp_coarse_to_obc : 291 of 732 temperature timesteps... 
interp_coarse_to_obc : 292 of 732 temperature timesteps... 
interp_coarse_to_obc : 293 of 732 temperature timesteps... 
interp_coarse_to_obc : 294 of 732 temperature timesteps... 
interp_coarse_to_obc : 295 of 732 temperature timesteps... 
interp_coarse_to_obc : 296 of 732 temperature timesteps... 
interp_coarse_to_obc : 297 of 732 temperature timesteps... 
interp_coarse_to_obc : 298 of 732 temperature timesteps... 
interp_coarse_to_obc : 299 of 732 temperature timesteps... 
interp_coarse_to_obc : 300 of 732 temperature timesteps... 
interp_coarse_to_obc : 301 of 732 temperature timesteps... 
interp_coarse_to_obc : 302 of 732 temperature timesteps... 
interp_coarse_to_obc : 303 of 732 temperature timesteps... 
interp_coarse_to_obc : 304 of 732 temperature timesteps... 
interp_coarse_to_obc : 305 of 732 temperature timesteps... 
interp_coarse_to_obc : 306 of 732 temperature timesteps... 
interp_coarse_to_obc : 307 of 732 temperature timesteps... 
interp_coarse_to_obc : 308 of 732 temperature timesteps... 
interp_coarse_to_obc : 309 of 732 temperature timesteps... 
interp_coarse_to_obc : 310 of 732 temperature timesteps... 
interp_coarse_to_obc : 311 of 732 temperature timesteps... 
interp_coarse_to_obc : 312 of 732 temperature timesteps... 
interp_coarse_to_obc : 313 of 732 temperature timesteps... 
interp_coarse_to_obc : 314 of 732 temperature timesteps... 
interp_coarse_to_obc : 315 of 732 temperature timesteps... 
interp_coarse_to_obc : 316 of 732 temperature timesteps... 
interp_coarse_to_obc : 317 of 732 temperature timesteps... 
interp_coarse_to_obc : 318 of 732 temperature timesteps... 
interp_coarse_to_obc : 319 of 732 temperature timesteps... 
interp_coarse_to_obc : 320 of 732 temperature timesteps... 
interp_coarse_to_obc : 321 of 732 temperature timesteps... 
interp_coarse_to_obc : 322 of 732 temperature timesteps... 
interp_coarse_to_obc : 323 of 732 temperature timesteps... 
interp_coarse_to_obc : 324 of 732 temperature timesteps... 
interp_coarse_to_obc : 325 of 732 temperature timesteps... 
interp_coarse_to_obc : 326 of 732 temperature timesteps... 
interp_coarse_to_obc : 327 of 732 temperature timesteps... 
interp_coarse_to_obc : 328 of 732 temperature timesteps... 
interp_coarse_to_obc : 329 of 732 temperature timesteps... 
interp_coarse_to_obc : 330 of 732 temperature timesteps... 
interp_coarse_to_obc : 331 of 732 temperature timesteps... 
interp_coarse_to_obc : 332 of 732 temperature timesteps... 
interp_coarse_to_obc : 333 of 732 temperature timesteps... 
interp_coarse_to_obc : 334 of 732 temperature timesteps... 
interp_coarse_to_obc : 335 of 732 temperature timesteps... 
interp_coarse_to_obc : 336 of 732 temperature timesteps... 
interp_coarse_to_obc : 337 of 732 temperature timesteps... 
interp_coarse_to_obc : 338 of 732 temperature timesteps... 
interp_coarse_to_obc : 339 of 732 temperature timesteps... 
interp_coarse_to_obc : 340 of 732 temperature timesteps... 
interp_coarse_to_obc : 341 of 732 temperature timesteps... 
interp_coarse_to_obc : 342 of 732 temperature timesteps... 
interp_coarse_to_obc : 343 of 732 temperature timesteps... 
interp_coarse_to_obc : 344 of 732 temperature timesteps... 
interp_coarse_to_obc : 345 of 732 temperature timesteps... 
interp_coarse_to_obc : 346 of 732 temperature timesteps... 
interp_coarse_to_obc : 347 of 732 temperature timesteps... 
interp_coarse_to_obc : 348 of 732 temperature timesteps... 
interp_coarse_to_obc : 349 of 732 temperature timesteps... 
interp_coarse_to_obc : 350 of 732 temperature timesteps... 
interp_coarse_to_obc : 351 of 732 temperature timesteps... 
interp_coarse_to_obc : 352 of 732 temperature timesteps... 
interp_coarse_to_obc : 353 of 732 temperature timesteps... 
interp_coarse_to_obc : 354 of 732 temperature timesteps... 
interp_coarse_to_obc : 355 of 732 temperature timesteps... 
interp_coarse_to_obc : 356 of 732 temperature timesteps... 
interp_coarse_to_obc : 357 of 732 temperature timesteps... 
interp_coarse_to_obc : 358 of 732 temperature timesteps... 
interp_coarse_to_obc : 359 of 732 temperature timesteps... 
interp_coarse_to_obc : 360 of 732 temperature timesteps... 
interp_coarse_to_obc : 361 of 732 temperature timesteps... 
interp_coarse_to_obc : 362 of 732 temperature timesteps... 
interp_coarse_to_obc : 363 of 732 temperature timesteps... 
interp_coarse_to_obc : 364 of 732 temperature timesteps... 
interp_coarse_to_obc : 365 of 732 temperature timesteps... 
interp_coarse_to_obc : 366 of 732 temperature timesteps... 
interp_coarse_to_obc : 367 of 732 temperature timesteps... 
interp_coarse_to_obc : 368 of 732 temperature timesteps... 
interp_coarse_to_obc : 369 of 732 temperature timesteps... 
interp_coarse_to_obc : 370 of 732 temperature timesteps... 
interp_coarse_to_obc : 371 of 732 temperature timesteps... 
interp_coarse_to_obc : 372 of 732 temperature timesteps... 
interp_coarse_to_obc : 373 of 732 temperature timesteps... 
interp_coarse_to_obc : 374 of 732 temperature timesteps... 
interp_coarse_to_obc : 375 of 732 temperature timesteps... 
interp_coarse_to_obc : 376 of 732 temperature timesteps... 
interp_coarse_to_obc : 377 of 732 temperature timesteps... 
interp_coarse_to_obc : 378 of 732 temperature timesteps... 
interp_coarse_to_obc : 379 of 732 temperature timesteps... 
interp_coarse_to_obc : 380 of 732 temperature timesteps... 
interp_coarse_to_obc : 381 of 732 temperature timesteps... 
interp_coarse_to_obc : 382 of 732 temperature timesteps... 
interp_coarse_to_obc : 383 of 732 temperature timesteps... 
interp_coarse_to_obc : 384 of 732 temperature timesteps... 
interp_coarse_to_obc : 385 of 732 temperature timesteps... 
interp_coarse_to_obc : 386 of 732 temperature timesteps... 
interp_coarse_to_obc : 387 of 732 temperature timesteps... 
interp_coarse_to_obc : 388 of 732 temperature timesteps... 
interp_coarse_to_obc : 389 of 732 temperature timesteps... 
interp_coarse_to_obc : 390 of 732 temperature timesteps... 
interp_coarse_to_obc : 391 of 732 temperature timesteps... 
interp_coarse_to_obc : 392 of 732 temperature timesteps... 
interp_coarse_to_obc : 393 of 732 temperature timesteps... 
interp_coarse_to_obc : 394 of 732 temperature timesteps... 
interp_coarse_to_obc : 395 of 732 temperature timesteps... 
interp_coarse_to_obc : 396 of 732 temperature timesteps... 
interp_coarse_to_obc : 397 of 732 temperature timesteps... 
interp_coarse_to_obc : 398 of 732 temperature timesteps... 
interp_coarse_to_obc : 399 of 732 temperature timesteps... 
interp_coarse_to_obc : 400 of 732 temperature timesteps... 
interp_coarse_to_obc : 401 of 732 temperature timesteps... 
interp_coarse_to_obc : 402 of 732 temperature timesteps... 
interp_coarse_to_obc : 403 of 732 temperature timesteps... 
interp_coarse_to_obc : 404 of 732 temperature timesteps... 
interp_coarse_to_obc : 405 of 732 temperature timesteps... 
interp_coarse_to_obc : 406 of 732 temperature timesteps... 
interp_coarse_to_obc : 407 of 732 temperature timesteps... 
interp_coarse_to_obc : 408 of 732 temperature timesteps... 
interp_coarse_to_obc : 409 of 732 temperature timesteps... 
interp_coarse_to_obc : 410 of 732 temperature timesteps... 
interp_coarse_to_obc : 411 of 732 temperature timesteps... 
interp_coarse_to_obc : 412 of 732 temperature timesteps... 
interp_coarse_to_obc : 413 of 732 temperature timesteps... 
interp_coarse_to_obc : 414 of 732 temperature timesteps... 
interp_coarse_to_obc : 415 of 732 temperature timesteps... 
interp_coarse_to_obc : 416 of 732 temperature timesteps... 
interp_coarse_to_obc : 417 of 732 temperature timesteps... 
interp_coarse_to_obc : 418 of 732 temperature timesteps... 
interp_coarse_to_obc : 419 of 732 temperature timesteps... 
interp_coarse_to_obc : 420 of 732 temperature timesteps... 
interp_coarse_to_obc : 421 of 732 temperature timesteps... 
interp_coarse_to_obc : 422 of 732 temperature timesteps... 
interp_coarse_to_obc : 423 of 732 temperature timesteps... 
interp_coarse_to_obc : 424 of 732 temperature timesteps... 
interp_coarse_to_obc : 425 of 732 temperature timesteps... 
interp_coarse_to_obc : 426 of 732 temperature timesteps... 
interp_coarse_to_obc : 427 of 732 temperature timesteps... 
interp_coarse_to_obc : 428 of 732 temperature timesteps... 
interp_coarse_to_obc : 429 of 732 temperature timesteps... 
interp_coarse_to_obc : 430 of 732 temperature timesteps... 
interp_coarse_to_obc : 431 of 732 temperature timesteps... 
interp_coarse_to_obc : 432 of 732 temperature timesteps... 
interp_coarse_to_obc : 433 of 732 temperature timesteps... 
interp_coarse_to_obc : 434 of 732 temperature timesteps... 
interp_coarse_to_obc : 435 of 732 temperature timesteps... 
interp_coarse_to_obc : 436 of 732 temperature timesteps... 
interp_coarse_to_obc : 437 of 732 temperature timesteps... 
interp_coarse_to_obc : 438 of 732 temperature timesteps... 
interp_coarse_to_obc : 439 of 732 temperature timesteps... 
interp_coarse_to_obc : 440 of 732 temperature timesteps... 
interp_coarse_to_obc : 441 of 732 temperature timesteps... 
interp_coarse_to_obc : 442 of 732 temperature timesteps... 
interp_coarse_to_obc : 443 of 732 temperature timesteps... 
interp_coarse_to_obc : 444 of 732 temperature timesteps... 
interp_coarse_to_obc : 445 of 732 temperature timesteps... 
interp_coarse_to_obc : 446 of 732 temperature timesteps... 
interp_coarse_to_obc : 447 of 732 temperature timesteps... 
interp_coarse_to_obc : 448 of 732 temperature timesteps... 
interp_coarse_to_obc : 449 of 732 temperature timesteps... 
interp_coarse_to_obc : 450 of 732 temperature timesteps... 
interp_coarse_to_obc : 451 of 732 temperature timesteps... 
interp_coarse_to_obc : 452 of 732 temperature timesteps... 
interp_coarse_to_obc : 453 of 732 temperature timesteps... 
interp_coarse_to_obc : 454 of 732 temperature timesteps... 
interp_coarse_to_obc : 455 of 732 temperature timesteps... 
interp_coarse_to_obc : 456 of 732 temperature timesteps... 
interp_coarse_to_obc : 457 of 732 temperature timesteps... 
interp_coarse_to_obc : 458 of 732 temperature timesteps... 
interp_coarse_to_obc : 459 of 732 temperature timesteps... 
interp_coarse_to_obc : 460 of 732 temperature timesteps... 
interp_coarse_to_obc : 461 of 732 temperature timesteps... 
interp_coarse_to_obc : 462 of 732 temperature timesteps... 
interp_coarse_to_obc : 463 of 732 temperature timesteps... 
interp_coarse_to_obc : 464 of 732 temperature timesteps... 
interp_coarse_to_obc : 465 of 732 temperature timesteps... 
interp_coarse_to_obc : 466 of 732 temperature timesteps... 
interp_coarse_to_obc : 467 of 732 temperature timesteps... 
interp_coarse_to_obc : 468 of 732 temperature timesteps... 
interp_coarse_to_obc : 469 of 732 temperature timesteps... 
interp_coarse_to_obc : 470 of 732 temperature timesteps... 
interp_coarse_to_obc : 471 of 732 temperature timesteps... 
interp_coarse_to_obc : 472 of 732 temperature timesteps... 
interp_coarse_to_obc : 473 of 732 temperature timesteps... 
interp_coarse_to_obc : 474 of 732 temperature timesteps... 
interp_coarse_to_obc : 475 of 732 temperature timesteps... 
interp_coarse_to_obc : 476 of 732 temperature timesteps... 
interp_coarse_to_obc : 477 of 732 temperature timesteps... 
interp_coarse_to_obc : 478 of 732 temperature timesteps... 
interp_coarse_to_obc : 479 of 732 temperature timesteps... 
interp_coarse_to_obc : 480 of 732 temperature timesteps... 
interp_coarse_to_obc : 481 of 732 temperature timesteps... 
interp_coarse_to_obc : 482 of 732 temperature timesteps... 
interp_coarse_to_obc : 483 of 732 temperature timesteps... 
interp_coarse_to_obc : 484 of 732 temperature timesteps... 
interp_coarse_to_obc : 485 of 732 temperature timesteps... 
interp_coarse_to_obc : 486 of 732 temperature timesteps... 
interp_coarse_to_obc : 487 of 732 temperature timesteps... 
interp_coarse_to_obc : 488 of 732 temperature timesteps... 
interp_coarse_to_obc : 489 of 732 temperature timesteps... 
interp_coarse_to_obc : 490 of 732 temperature timesteps... 
interp_coarse_to_obc : 491 of 732 temperature timesteps... 
interp_coarse_to_obc : 492 of 732 temperature timesteps... 
interp_coarse_to_obc : 493 of 732 temperature timesteps... 
interp_coarse_to_obc : 494 of 732 temperature timesteps... 
interp_coarse_to_obc : 495 of 732 temperature timesteps... 
interp_coarse_to_obc : 496 of 732 temperature timesteps... 
interp_coarse_to_obc : 497 of 732 temperature timesteps... 
interp_coarse_to_obc : 498 of 732 temperature timesteps... 
interp_coarse_to_obc : 499 of 732 temperature timesteps... 
interp_coarse_to_obc : 500 of 732 temperature timesteps... 
interp_coarse_to_obc : 501 of 732 temperature timesteps... 
interp_coarse_to_obc : 502 of 732 temperature timesteps... 
interp_coarse_to_obc : 503 of 732 temperature timesteps... 
interp_coarse_to_obc : 504 of 732 temperature timesteps... 
interp_coarse_to_obc : 505 of 732 temperature timesteps... 
interp_coarse_to_obc : 506 of 732 temperature timesteps... 
interp_coarse_to_obc : 507 of 732 temperature timesteps... 
interp_coarse_to_obc : 508 of 732 temperature timesteps... 
interp_coarse_to_obc : 509 of 732 temperature timesteps... 
interp_coarse_to_obc : 510 of 732 temperature timesteps... 
interp_coarse_to_obc : 511 of 732 temperature timesteps... 
interp_coarse_to_obc : 512 of 732 temperature timesteps... 
interp_coarse_to_obc : 513 of 732 temperature timesteps... 
interp_coarse_to_obc : 514 of 732 temperature timesteps... 
interp_coarse_to_obc : 515 of 732 temperature timesteps... 
interp_coarse_to_obc : 516 of 732 temperature timesteps... 
interp_coarse_to_obc : 517 of 732 temperature timesteps... 
interp_coarse_to_obc : 518 of 732 temperature timesteps... 
interp_coarse_to_obc : 519 of 732 temperature timesteps... 
interp_coarse_to_obc : 520 of 732 temperature timesteps... 
interp_coarse_to_obc : 521 of 732 temperature timesteps... 
interp_coarse_to_obc : 522 of 732 temperature timesteps... 
interp_coarse_to_obc : 523 of 732 temperature timesteps... 
interp_coarse_to_obc : 524 of 732 temperature timesteps... 
interp_coarse_to_obc : 525 of 732 temperature timesteps... 
interp_coarse_to_obc : 526 of 732 temperature timesteps... 
interp_coarse_to_obc : 527 of 732 temperature timesteps... 
interp_coarse_to_obc : 528 of 732 temperature timesteps... 
interp_coarse_to_obc : 529 of 732 temperature timesteps... 
interp_coarse_to_obc : 530 of 732 temperature timesteps... 
interp_coarse_to_obc : 531 of 732 temperature timesteps... 
interp_coarse_to_obc : 532 of 732 temperature timesteps... 
interp_coarse_to_obc : 533 of 732 temperature timesteps... 
interp_coarse_to_obc : 534 of 732 temperature timesteps... 
interp_coarse_to_obc : 535 of 732 temperature timesteps... 
interp_coarse_to_obc : 536 of 732 temperature timesteps... 
interp_coarse_to_obc : 537 of 732 temperature timesteps... 
interp_coarse_to_obc : 538 of 732 temperature timesteps... 
interp_coarse_to_obc : 539 of 732 temperature timesteps... 
interp_coarse_to_obc : 540 of 732 temperature timesteps... 
interp_coarse_to_obc : 541 of 732 temperature timesteps... 
interp_coarse_to_obc : 542 of 732 temperature timesteps... 
interp_coarse_to_obc : 543 of 732 temperature timesteps... 
interp_coarse_to_obc : 544 of 732 temperature timesteps... 
interp_coarse_to_obc : 545 of 732 temperature timesteps... 
interp_coarse_to_obc : 546 of 732 temperature timesteps... 
interp_coarse_to_obc : 547 of 732 temperature timesteps... 
interp_coarse_to_obc : 548 of 732 temperature timesteps... 
interp_coarse_to_obc : 549 of 732 temperature timesteps... 
interp_coarse_to_obc : 550 of 732 temperature timesteps... 
interp_coarse_to_obc : 551 of 732 temperature timesteps... 
interp_coarse_to_obc : 552 of 732 temperature timesteps... 
interp_coarse_to_obc : 553 of 732 temperature timesteps... 
interp_coarse_to_obc : 554 of 732 temperature timesteps... 
interp_coarse_to_obc : 555 of 732 temperature timesteps... 
interp_coarse_to_obc : 556 of 732 temperature timesteps... 
interp_coarse_to_obc : 557 of 732 temperature timesteps... 
interp_coarse_to_obc : 558 of 732 temperature timesteps... 
interp_coarse_to_obc : 559 of 732 temperature timesteps... 
interp_coarse_to_obc : 560 of 732 temperature timesteps... 
interp_coarse_to_obc : 561 of 732 temperature timesteps... 
interp_coarse_to_obc : 562 of 732 temperature timesteps... 
interp_coarse_to_obc : 563 of 732 temperature timesteps... 
interp_coarse_to_obc : 564 of 732 temperature timesteps... 
interp_coarse_to_obc : 565 of 732 temperature timesteps... 
interp_coarse_to_obc : 566 of 732 temperature timesteps... 
interp_coarse_to_obc : 567 of 732 temperature timesteps... 
interp_coarse_to_obc : 568 of 732 temperature timesteps... 
interp_coarse_to_obc : 569 of 732 temperature timesteps... 
interp_coarse_to_obc : 570 of 732 temperature timesteps... 
interp_coarse_to_obc : 571 of 732 temperature timesteps... 
interp_coarse_to_obc : 572 of 732 temperature timesteps... 
interp_coarse_to_obc : 573 of 732 temperature timesteps... 
interp_coarse_to_obc : 574 of 732 temperature timesteps... 
interp_coarse_to_obc : 575 of 732 temperature timesteps... 
interp_coarse_to_obc : 576 of 732 temperature timesteps... 
interp_coarse_to_obc : 577 of 732 temperature timesteps... 
interp_coarse_to_obc : 578 of 732 temperature timesteps... 
interp_coarse_to_obc : 579 of 732 temperature timesteps... 
interp_coarse_to_obc : 580 of 732 temperature timesteps... 
interp_coarse_to_obc : 581 of 732 temperature timesteps... 
interp_coarse_to_obc : 582 of 732 temperature timesteps... 
interp_coarse_to_obc : 583 of 732 temperature timesteps... 
interp_coarse_to_obc : 584 of 732 temperature timesteps... 
interp_coarse_to_obc : 585 of 732 temperature timesteps... 
interp_coarse_to_obc : 586 of 732 temperature timesteps... 
interp_coarse_to_obc : 587 of 732 temperature timesteps... 
interp_coarse_to_obc : 588 of 732 temperature timesteps... 
interp_coarse_to_obc : 589 of 732 temperature timesteps... 
interp_coarse_to_obc : 590 of 732 temperature timesteps... 
interp_coarse_to_obc : 591 of 732 temperature timesteps... 
interp_coarse_to_obc : 592 of 732 temperature timesteps... 
interp_coarse_to_obc : 593 of 732 temperature timesteps... 
interp_coarse_to_obc : 594 of 732 temperature timesteps... 
interp_coarse_to_obc : 595 of 732 temperature timesteps... 
interp_coarse_to_obc : 596 of 732 temperature timesteps... 
interp_coarse_to_obc : 597 of 732 temperature timesteps... 
interp_coarse_to_obc : 598 of 732 temperature timesteps... 
interp_coarse_to_obc : 599 of 732 temperature timesteps... 
interp_coarse_to_obc : 600 of 732 temperature timesteps... 
interp_coarse_to_obc : 601 of 732 temperature timesteps... 
interp_coarse_to_obc : 602 of 732 temperature timesteps... 
interp_coarse_to_obc : 603 of 732 temperature timesteps... 
interp_coarse_to_obc : 604 of 732 temperature timesteps... 
interp_coarse_to_obc : 605 of 732 temperature timesteps... 
interp_coarse_to_obc : 606 of 732 temperature timesteps... 
interp_coarse_to_obc : 607 of 732 temperature timesteps... 
interp_coarse_to_obc : 608 of 732 temperature timesteps... 
interp_coarse_to_obc : 609 of 732 temperature timesteps... 
interp_coarse_to_obc : 610 of 732 temperature timesteps... 
interp_coarse_to_obc : 611 of 732 temperature timesteps... 
interp_coarse_to_obc : 612 of 732 temperature timesteps... 
interp_coarse_to_obc : 613 of 732 temperature timesteps... 
interp_coarse_to_obc : 614 of 732 temperature timesteps... 
interp_coarse_to_obc : 615 of 732 temperature timesteps... 
interp_coarse_to_obc : 616 of 732 temperature timesteps... 
interp_coarse_to_obc : 617 of 732 temperature timesteps... 
interp_coarse_to_obc : 618 of 732 temperature timesteps... 
interp_coarse_to_obc : 619 of 732 temperature timesteps... 
interp_coarse_to_obc : 620 of 732 temperature timesteps... 
interp_coarse_to_obc : 621 of 732 temperature timesteps... 
interp_coarse_to_obc : 622 of 732 temperature timesteps... 
interp_coarse_to_obc : 623 of 732 temperature timesteps... 
interp_coarse_to_obc : 624 of 732 temperature timesteps... 
interp_coarse_to_obc : 625 of 732 temperature timesteps... 
interp_coarse_to_obc : 626 of 732 temperature timesteps... 
interp_coarse_to_obc : 627 of 732 temperature timesteps... 
interp_coarse_to_obc : 628 of 732 temperature timesteps... 
interp_coarse_to_obc : 629 of 732 temperature timesteps... 
interp_coarse_to_obc : 630 of 732 temperature timesteps... 
interp_coarse_to_obc : 631 of 732 temperature timesteps... 
interp_coarse_to_obc : 632 of 732 temperature timesteps... 
interp_coarse_to_obc : 633 of 732 temperature timesteps... 
interp_coarse_to_obc : 634 of 732 temperature timesteps... 
interp_coarse_to_obc : 635 of 732 temperature timesteps... 
interp_coarse_to_obc : 636 of 732 temperature timesteps... 
interp_coarse_to_obc : 637 of 732 temperature timesteps... 
interp_coarse_to_obc : 638 of 732 temperature timesteps... 
interp_coarse_to_obc : 639 of 732 temperature timesteps... 
interp_coarse_to_obc : 640 of 732 temperature timesteps... 
interp_coarse_to_obc : 641 of 732 temperature timesteps... 
interp_coarse_to_obc : 642 of 732 temperature timesteps... 
interp_coarse_to_obc : 643 of 732 temperature timesteps... 
interp_coarse_to_obc : 644 of 732 temperature timesteps... 
interp_coarse_to_obc : 645 of 732 temperature timesteps... 
interp_coarse_to_obc : 646 of 732 temperature timesteps... 
interp_coarse_to_obc : 647 of 732 temperature timesteps... 
interp_coarse_to_obc : 648 of 732 temperature timesteps... 
interp_coarse_to_obc : 649 of 732 temperature timesteps... 
interp_coarse_to_obc : 650 of 732 temperature timesteps... 
interp_coarse_to_obc : 651 of 732 temperature timesteps... 
interp_coarse_to_obc : 652 of 732 temperature timesteps... 
interp_coarse_to_obc : 653 of 732 temperature timesteps... 
interp_coarse_to_obc : 654 of 732 temperature timesteps... 
interp_coarse_to_obc : 655 of 732 temperature timesteps... 
interp_coarse_to_obc : 656 of 732 temperature timesteps... 
interp_coarse_to_obc : 657 of 732 temperature timesteps... 
interp_coarse_to_obc : 658 of 732 temperature timesteps... 
interp_coarse_to_obc : 659 of 732 temperature timesteps... 
interp_coarse_to_obc : 660 of 732 temperature timesteps... 
interp_coarse_to_obc : 661 of 732 temperature timesteps... 
interp_coarse_to_obc : 662 of 732 temperature timesteps... 
interp_coarse_to_obc : 663 of 732 temperature timesteps... 
interp_coarse_to_obc : 664 of 732 temperature timesteps... 
interp_coarse_to_obc : 665 of 732 temperature timesteps... 
interp_coarse_to_obc : 666 of 732 temperature timesteps... 
interp_coarse_to_obc : 667 of 732 temperature timesteps... 
interp_coarse_to_obc : 668 of 732 temperature timesteps... 
interp_coarse_to_obc : 669 of 732 temperature timesteps... 
interp_coarse_to_obc : 670 of 732 temperature timesteps... 
interp_coarse_to_obc : 671 of 732 temperature timesteps... 
interp_coarse_to_obc : 672 of 732 temperature timesteps... 
interp_coarse_to_obc : 673 of 732 temperature timesteps... 
interp_coarse_to_obc : 674 of 732 temperature timesteps... 
interp_coarse_to_obc : 675 of 732 temperature timesteps... 
interp_coarse_to_obc : 676 of 732 temperature timesteps... 
interp_coarse_to_obc : 677 of 732 temperature timesteps... 
interp_coarse_to_obc : 678 of 732 temperature timesteps... 
interp_coarse_to_obc : 679 of 732 temperature timesteps... 
interp_coarse_to_obc : 680 of 732 temperature timesteps... 
interp_coarse_to_obc : 681 of 732 temperature timesteps... 
interp_coarse_to_obc : 682 of 732 temperature timesteps... 
interp_coarse_to_obc : 683 of 732 temperature timesteps... 
interp_coarse_to_obc : 684 of 732 temperature timesteps... 
interp_coarse_to_obc : 685 of 732 temperature timesteps... 
interp_coarse_to_obc : 686 of 732 temperature timesteps... 
interp_coarse_to_obc : 687 of 732 temperature timesteps... 
interp_coarse_to_obc : 688 of 732 temperature timesteps... 
interp_coarse_to_obc : 689 of 732 temperature timesteps... 
interp_coarse_to_obc : 690 of 732 temperature timesteps... 
interp_coarse_to_obc : 691 of 732 temperature timesteps... 
interp_coarse_to_obc : 692 of 732 temperature timesteps... 
interp_coarse_to_obc : 693 of 732 temperature timesteps... 
interp_coarse_to_obc : 694 of 732 temperature timesteps... 
interp_coarse_to_obc : 695 of 732 temperature timesteps... 
interp_coarse_to_obc : 696 of 732 temperature timesteps... 
interp_coarse_to_obc : 697 of 732 temperature timesteps... 
interp_coarse_to_obc : 698 of 732 temperature timesteps... 
interp_coarse_to_obc : 699 of 732 temperature timesteps... 
interp_coarse_to_obc : 700 of 732 temperature timesteps... 
interp_coarse_to_obc : 701 of 732 temperature timesteps... 
interp_coarse_to_obc : 702 of 732 temperature timesteps... 
interp_coarse_to_obc : 703 of 732 temperature timesteps... 
interp_coarse_to_obc : 704 of 732 temperature timesteps... 
interp_coarse_to_obc : 705 of 732 temperature timesteps... 
interp_coarse_to_obc : 706 of 732 temperature timesteps... 
interp_coarse_to_obc : 707 of 732 temperature timesteps... 
interp_coarse_to_obc : 708 of 732 temperature timesteps... 
interp_coarse_to_obc : 709 of 732 temperature timesteps... 
interp_coarse_to_obc : 710 of 732 temperature timesteps... 
interp_coarse_to_obc : 711 of 732 temperature timesteps... 
interp_coarse_to_obc : 712 of 732 temperature timesteps... 
interp_coarse_to_obc : 713 of 732 temperature timesteps... 
interp_coarse_to_obc : 714 of 732 temperature timesteps... 
interp_coarse_to_obc : 715 of 732 temperature timesteps... 
interp_coarse_to_obc : 716 of 732 temperature timesteps... 
interp_coarse_to_obc : 717 of 732 temperature timesteps... 
interp_coarse_to_obc : 718 of 732 temperature timesteps... 
interp_coarse_to_obc : 719 of 732 temperature timesteps... 
interp_coarse_to_obc : 720 of 732 temperature timesteps... 
interp_coarse_to_obc : 721 of 732 temperature timesteps... 
interp_coarse_to_obc : 722 of 732 temperature timesteps... 
interp_coarse_to_obc : 723 of 732 temperature timesteps... 
interp_coarse_to_obc : 724 of 732 temperature timesteps... 
interp_coarse_to_obc : 725 of 732 temperature timesteps... 
interp_coarse_to_obc : 726 of 732 temperature timesteps... 
interp_coarse_to_obc : 727 of 732 temperature timesteps... 
interp_coarse_to_obc : 728 of 732 temperature timesteps... 
interp_coarse_to_obc : 729 of 732 temperature timesteps... 
interp_coarse_to_obc : 730 of 732 temperature timesteps... 
interp_coarse_to_obc : 731 of 732 temperature timesteps... 
interp_coarse_to_obc : 732 of 732 temperature timesteps... 

begin : interp_coarse_to_obc
Variable salinity on nodes (36 positions)
interp_coarse_to_obc : 1 of 732 salinity timesteps... 
interp_coarse_to_obc : 2 of 732 salinity timesteps... 
interp_coarse_to_obc : 3 of 732 salinity timesteps... 
interp_coarse_to_obc : 4 of 732 salinity timesteps... 
interp_coarse_to_obc : 5 of 732 salinity timesteps... 
interp_coarse_to_obc : 6 of 732 salinity timesteps... 
interp_coarse_to_obc : 7 of 732 salinity timesteps... 
interp_coarse_to_obc : 8 of 732 salinity timesteps... 
interp_coarse_to_obc : 9 of 732 salinity timesteps... 
interp_coarse_to_obc : 10 of 732 salinity timesteps... 
interp_coarse_to_obc : 11 of 732 salinity timesteps... 
interp_coarse_to_obc : 12 of 732 salinity timesteps... 
interp_coarse_to_obc : 13 of 732 salinity timesteps... 
interp_coarse_to_obc : 14 of 732 salinity timesteps... 
interp_coarse_to_obc : 15 of 732 salinity timesteps... 
interp_coarse_to_obc : 16 of 732 salinity timesteps... 
interp_coarse_to_obc : 17 of 732 salinity timesteps... 
interp_coarse_to_obc : 18 of 732 salinity timesteps... 
interp_coarse_to_obc : 19 of 732 salinity timesteps... 
interp_coarse_to_obc : 20 of 732 salinity timesteps... 
interp_coarse_to_obc : 21 of 732 salinity timesteps... 
interp_coarse_to_obc : 22 of 732 salinity timesteps... 
interp_coarse_to_obc : 23 of 732 salinity timesteps... 
interp_coarse_to_obc : 24 of 732 salinity timesteps... 
interp_coarse_to_obc : 25 of 732 salinity timesteps... 
interp_coarse_to_obc : 26 of 732 salinity timesteps... 
interp_coarse_to_obc : 27 of 732 salinity timesteps... 
interp_coarse_to_obc : 28 of 732 salinity timesteps... 
interp_coarse_to_obc : 29 of 732 salinity timesteps... 
interp_coarse_to_obc : 30 of 732 salinity timesteps... 
interp_coarse_to_obc : 31 of 732 salinity timesteps... 
interp_coarse_to_obc : 32 of 732 salinity timesteps... 
interp_coarse_to_obc : 33 of 732 salinity timesteps... 
interp_coarse_to_obc : 34 of 732 salinity timesteps... 
interp_coarse_to_obc : 35 of 732 salinity timesteps... 
interp_coarse_to_obc : 36 of 732 salinity timesteps... 
interp_coarse_to_obc : 37 of 732 salinity timesteps... 
interp_coarse_to_obc : 38 of 732 salinity timesteps... 
interp_coarse_to_obc : 39 of 732 salinity timesteps... 
interp_coarse_to_obc : 40 of 732 salinity timesteps... 
interp_coarse_to_obc : 41 of 732 salinity timesteps... 
interp_coarse_to_obc : 42 of 732 salinity timesteps... 
interp_coarse_to_obc : 43 of 732 salinity timesteps... 
interp_coarse_to_obc : 44 of 732 salinity timesteps... 
interp_coarse_to_obc : 45 of 732 salinity timesteps... 
interp_coarse_to_obc : 46 of 732 salinity timesteps... 
interp_coarse_to_obc : 47 of 732 salinity timesteps... 
interp_coarse_to_obc : 48 of 732 salinity timesteps... 
interp_coarse_to_obc : 49 of 732 salinity timesteps... 
interp_coarse_to_obc : 50 of 732 salinity timesteps... 
interp_coarse_to_obc : 51 of 732 salinity timesteps... 
interp_coarse_to_obc : 52 of 732 salinity timesteps... 
interp_coarse_to_obc : 53 of 732 salinity timesteps... 
interp_coarse_to_obc : 54 of 732 salinity timesteps... 
interp_coarse_to_obc : 55 of 732 salinity timesteps... 
interp_coarse_to_obc : 56 of 732 salinity timesteps... 
interp_coarse_to_obc : 57 of 732 salinity timesteps... 
interp_coarse_to_obc : 58 of 732 salinity timesteps... 
interp_coarse_to_obc : 59 of 732 salinity timesteps... 
interp_coarse_to_obc : 60 of 732 salinity timesteps... 
interp_coarse_to_obc : 61 of 732 salinity timesteps... 
interp_coarse_to_obc : 62 of 732 salinity timesteps... 
interp_coarse_to_obc : 63 of 732 salinity timesteps... 
interp_coarse_to_obc : 64 of 732 salinity timesteps... 
interp_coarse_to_obc : 65 of 732 salinity timesteps... 
interp_coarse_to_obc : 66 of 732 salinity timesteps... 
interp_coarse_to_obc : 67 of 732 salinity timesteps... 
interp_coarse_to_obc : 68 of 732 salinity timesteps... 
interp_coarse_to_obc : 69 of 732 salinity timesteps... 
interp_coarse_to_obc : 70 of 732 salinity timesteps... 
interp_coarse_to_obc : 71 of 732 salinity timesteps... 
interp_coarse_to_obc : 72 of 732 salinity timesteps... 
interp_coarse_to_obc : 73 of 732 salinity timesteps... 
interp_coarse_to_obc : 74 of 732 salinity timesteps... 
interp_coarse_to_obc : 75 of 732 salinity timesteps... 
interp_coarse_to_obc : 76 of 732 salinity timesteps... 
interp_coarse_to_obc : 77 of 732 salinity timesteps... 
interp_coarse_to_obc : 78 of 732 salinity timesteps... 
interp_coarse_to_obc : 79 of 732 salinity timesteps... 
interp_coarse_to_obc : 80 of 732 salinity timesteps... 
interp_coarse_to_obc : 81 of 732 salinity timesteps... 
interp_coarse_to_obc : 82 of 732 salinity timesteps... 
interp_coarse_to_obc : 83 of 732 salinity timesteps... 
interp_coarse_to_obc : 84 of 732 salinity timesteps... 
interp_coarse_to_obc : 85 of 732 salinity timesteps... 
interp_coarse_to_obc : 86 of 732 salinity timesteps... 
interp_coarse_to_obc : 87 of 732 salinity timesteps... 
interp_coarse_to_obc : 88 of 732 salinity timesteps... 
interp_coarse_to_obc : 89 of 732 salinity timesteps... 
interp_coarse_to_obc : 90 of 732 salinity timesteps... 
interp_coarse_to_obc : 91 of 732 salinity timesteps... 
interp_coarse_to_obc : 92 of 732 salinity timesteps... 
interp_coarse_to_obc : 93 of 732 salinity timesteps... 
interp_coarse_to_obc : 94 of 732 salinity timesteps... 
interp_coarse_to_obc : 95 of 732 salinity timesteps... 
interp_coarse_to_obc : 96 of 732 salinity timesteps... 
interp_coarse_to_obc : 97 of 732 salinity timesteps... 
interp_coarse_to_obc : 98 of 732 salinity timesteps... 
interp_coarse_to_obc : 99 of 732 salinity timesteps... 
interp_coarse_to_obc : 100 of 732 salinity timesteps... 
interp_coarse_to_obc : 101 of 732 salinity timesteps... 
interp_coarse_to_obc : 102 of 732 salinity timesteps... 
interp_coarse_to_obc : 103 of 732 salinity timesteps... 
interp_coarse_to_obc : 104 of 732 salinity timesteps... 
interp_coarse_to_obc : 105 of 732 salinity timesteps... 
interp_coarse_to_obc : 106 of 732 salinity timesteps... 
interp_coarse_to_obc : 107 of 732 salinity timesteps... 
interp_coarse_to_obc : 108 of 732 salinity timesteps... 
interp_coarse_to_obc : 109 of 732 salinity timesteps... 
interp_coarse_to_obc : 110 of 732 salinity timesteps... 
interp_coarse_to_obc : 111 of 732 salinity timesteps... 
interp_coarse_to_obc : 112 of 732 salinity timesteps... 
interp_coarse_to_obc : 113 of 732 salinity timesteps... 
interp_coarse_to_obc : 114 of 732 salinity timesteps... 
interp_coarse_to_obc : 115 of 732 salinity timesteps... 
interp_coarse_to_obc : 116 of 732 salinity timesteps... 
interp_coarse_to_obc : 117 of 732 salinity timesteps... 
interp_coarse_to_obc : 118 of 732 salinity timesteps... 
interp_coarse_to_obc : 119 of 732 salinity timesteps... 
interp_coarse_to_obc : 120 of 732 salinity timesteps... 
interp_coarse_to_obc : 121 of 732 salinity timesteps... 
interp_coarse_to_obc : 122 of 732 salinity timesteps... 
interp_coarse_to_obc : 123 of 732 salinity timesteps... 
interp_coarse_to_obc : 124 of 732 salinity timesteps... 
interp_coarse_to_obc : 125 of 732 salinity timesteps... 
interp_coarse_to_obc : 126 of 732 salinity timesteps... 
interp_coarse_to_obc : 127 of 732 salinity timesteps... 
interp_coarse_to_obc : 128 of 732 salinity timesteps... 
interp_coarse_to_obc : 129 of 732 salinity timesteps... 
interp_coarse_to_obc : 130 of 732 salinity timesteps... 
interp_coarse_to_obc : 131 of 732 salinity timesteps... 
interp_coarse_to_obc : 132 of 732 salinity timesteps... 
interp_coarse_to_obc : 133 of 732 salinity timesteps... 
interp_coarse_to_obc : 134 of 732 salinity timesteps... 
interp_coarse_to_obc : 135 of 732 salinity timesteps... 
interp_coarse_to_obc : 136 of 732 salinity timesteps... 
interp_coarse_to_obc : 137 of 732 salinity timesteps... 
interp_coarse_to_obc : 138 of 732 salinity timesteps... 
interp_coarse_to_obc : 139 of 732 salinity timesteps... 
interp_coarse_to_obc : 140 of 732 salinity timesteps... 
interp_coarse_to_obc : 141 of 732 salinity timesteps... 
interp_coarse_to_obc : 142 of 732 salinity timesteps... 
interp_coarse_to_obc : 143 of 732 salinity timesteps... 
interp_coarse_to_obc : 144 of 732 salinity timesteps... 
interp_coarse_to_obc : 145 of 732 salinity timesteps... 
interp_coarse_to_obc : 146 of 732 salinity timesteps... 
interp_coarse_to_obc : 147 of 732 salinity timesteps... 
interp_coarse_to_obc : 148 of 732 salinity timesteps... 
interp_coarse_to_obc : 149 of 732 salinity timesteps... 
interp_coarse_to_obc : 150 of 732 salinity timesteps... 
interp_coarse_to_obc : 151 of 732 salinity timesteps... 
interp_coarse_to_obc : 152 of 732 salinity timesteps... 
interp_coarse_to_obc : 153 of 732 salinity timesteps... 
interp_coarse_to_obc : 154 of 732 salinity timesteps... 
interp_coarse_to_obc : 155 of 732 salinity timesteps... 
interp_coarse_to_obc : 156 of 732 salinity timesteps... 
interp_coarse_to_obc : 157 of 732 salinity timesteps... 
interp_coarse_to_obc : 158 of 732 salinity timesteps... 
interp_coarse_to_obc : 159 of 732 salinity timesteps... 
interp_coarse_to_obc : 160 of 732 salinity timesteps... 
interp_coarse_to_obc : 161 of 732 salinity timesteps... 
interp_coarse_to_obc : 162 of 732 salinity timesteps... 
interp_coarse_to_obc : 163 of 732 salinity timesteps... 
interp_coarse_to_obc : 164 of 732 salinity timesteps... 
interp_coarse_to_obc : 165 of 732 salinity timesteps... 
interp_coarse_to_obc : 166 of 732 salinity timesteps... 
interp_coarse_to_obc : 167 of 732 salinity timesteps... 
interp_coarse_to_obc : 168 of 732 salinity timesteps... 
interp_coarse_to_obc : 169 of 732 salinity timesteps... 
interp_coarse_to_obc : 170 of 732 salinity timesteps... 
interp_coarse_to_obc : 171 of 732 salinity timesteps... 
interp_coarse_to_obc : 172 of 732 salinity timesteps... 
interp_coarse_to_obc : 173 of 732 salinity timesteps... 
interp_coarse_to_obc : 174 of 732 salinity timesteps... 
interp_coarse_to_obc : 175 of 732 salinity timesteps... 
interp_coarse_to_obc : 176 of 732 salinity timesteps... 
interp_coarse_to_obc : 177 of 732 salinity timesteps... 
interp_coarse_to_obc : 178 of 732 salinity timesteps... 
interp_coarse_to_obc : 179 of 732 salinity timesteps... 
interp_coarse_to_obc : 180 of 732 salinity timesteps... 
interp_coarse_to_obc : 181 of 732 salinity timesteps... 
interp_coarse_to_obc : 182 of 732 salinity timesteps... 
interp_coarse_to_obc : 183 of 732 salinity timesteps... 
interp_coarse_to_obc : 184 of 732 salinity timesteps... 
interp_coarse_to_obc : 185 of 732 salinity timesteps... 
interp_coarse_to_obc : 186 of 732 salinity timesteps... 
interp_coarse_to_obc : 187 of 732 salinity timesteps... 
interp_coarse_to_obc : 188 of 732 salinity timesteps... 
interp_coarse_to_obc : 189 of 732 salinity timesteps... 
interp_coarse_to_obc : 190 of 732 salinity timesteps... 
interp_coarse_to_obc : 191 of 732 salinity timesteps... 
interp_coarse_to_obc : 192 of 732 salinity timesteps... 
interp_coarse_to_obc : 193 of 732 salinity timesteps... 
interp_coarse_to_obc : 194 of 732 salinity timesteps... 
interp_coarse_to_obc : 195 of 732 salinity timesteps... 
interp_coarse_to_obc : 196 of 732 salinity timesteps... 
interp_coarse_to_obc : 197 of 732 salinity timesteps... 
interp_coarse_to_obc : 198 of 732 salinity timesteps... 
interp_coarse_to_obc : 199 of 732 salinity timesteps... 
interp_coarse_to_obc : 200 of 732 salinity timesteps... 
interp_coarse_to_obc : 201 of 732 salinity timesteps... 
interp_coarse_to_obc : 202 of 732 salinity timesteps... 
interp_coarse_to_obc : 203 of 732 salinity timesteps... 
interp_coarse_to_obc : 204 of 732 salinity timesteps... 
interp_coarse_to_obc : 205 of 732 salinity timesteps... 
interp_coarse_to_obc : 206 of 732 salinity timesteps... 
interp_coarse_to_obc : 207 of 732 salinity timesteps... 
interp_coarse_to_obc : 208 of 732 salinity timesteps... 
interp_coarse_to_obc : 209 of 732 salinity timesteps... 
interp_coarse_to_obc : 210 of 732 salinity timesteps... 
interp_coarse_to_obc : 211 of 732 salinity timesteps... 
interp_coarse_to_obc : 212 of 732 salinity timesteps... 
interp_coarse_to_obc : 213 of 732 salinity timesteps... 
interp_coarse_to_obc : 214 of 732 salinity timesteps... 
interp_coarse_to_obc : 215 of 732 salinity timesteps... 
interp_coarse_to_obc : 216 of 732 salinity timesteps... 
interp_coarse_to_obc : 217 of 732 salinity timesteps... 
interp_coarse_to_obc : 218 of 732 salinity timesteps... 
interp_coarse_to_obc : 219 of 732 salinity timesteps... 
interp_coarse_to_obc : 220 of 732 salinity timesteps... 
interp_coarse_to_obc : 221 of 732 salinity timesteps... 
interp_coarse_to_obc : 222 of 732 salinity timesteps... 
interp_coarse_to_obc : 223 of 732 salinity timesteps... 
interp_coarse_to_obc : 224 of 732 salinity timesteps... 
interp_coarse_to_obc : 225 of 732 salinity timesteps... 
interp_coarse_to_obc : 226 of 732 salinity timesteps... 
interp_coarse_to_obc : 227 of 732 salinity timesteps... 
interp_coarse_to_obc : 228 of 732 salinity timesteps... 
interp_coarse_to_obc : 229 of 732 salinity timesteps... 
interp_coarse_to_obc : 230 of 732 salinity timesteps... 
interp_coarse_to_obc : 231 of 732 salinity timesteps... 
interp_coarse_to_obc : 232 of 732 salinity timesteps... 
interp_coarse_to_obc : 233 of 732 salinity timesteps... 
interp_coarse_to_obc : 234 of 732 salinity timesteps... 
interp_coarse_to_obc : 235 of 732 salinity timesteps... 
interp_coarse_to_obc : 236 of 732 salinity timesteps... 
interp_coarse_to_obc : 237 of 732 salinity timesteps... 
interp_coarse_to_obc : 238 of 732 salinity timesteps... 
interp_coarse_to_obc : 239 of 732 salinity timesteps... 
interp_coarse_to_obc : 240 of 732 salinity timesteps... 
interp_coarse_to_obc : 241 of 732 salinity timesteps... 
interp_coarse_to_obc : 242 of 732 salinity timesteps... 
interp_coarse_to_obc : 243 of 732 salinity timesteps... 
interp_coarse_to_obc : 244 of 732 salinity timesteps... 
interp_coarse_to_obc : 245 of 732 salinity timesteps... 
interp_coarse_to_obc : 246 of 732 salinity timesteps... 
interp_coarse_to_obc : 247 of 732 salinity timesteps... 
interp_coarse_to_obc : 248 of 732 salinity timesteps... 
interp_coarse_to_obc : 249 of 732 salinity timesteps... 
interp_coarse_to_obc : 250 of 732 salinity timesteps... 
interp_coarse_to_obc : 251 of 732 salinity timesteps... 
interp_coarse_to_obc : 252 of 732 salinity timesteps... 
interp_coarse_to_obc : 253 of 732 salinity timesteps... 
interp_coarse_to_obc : 254 of 732 salinity timesteps... 
interp_coarse_to_obc : 255 of 732 salinity timesteps... 
interp_coarse_to_obc : 256 of 732 salinity timesteps... 
interp_coarse_to_obc : 257 of 732 salinity timesteps... 
interp_coarse_to_obc : 258 of 732 salinity timesteps... 
interp_coarse_to_obc : 259 of 732 salinity timesteps... 
interp_coarse_to_obc : 260 of 732 salinity timesteps... 
interp_coarse_to_obc : 261 of 732 salinity timesteps... 
interp_coarse_to_obc : 262 of 732 salinity timesteps... 
interp_coarse_to_obc : 263 of 732 salinity timesteps... 
interp_coarse_to_obc : 264 of 732 salinity timesteps... 
interp_coarse_to_obc : 265 of 732 salinity timesteps... 
interp_coarse_to_obc : 266 of 732 salinity timesteps... 
interp_coarse_to_obc : 267 of 732 salinity timesteps... 
interp_coarse_to_obc : 268 of 732 salinity timesteps... 
interp_coarse_to_obc : 269 of 732 salinity timesteps... 
interp_coarse_to_obc : 270 of 732 salinity timesteps... 
interp_coarse_to_obc : 271 of 732 salinity timesteps... 
interp_coarse_to_obc : 272 of 732 salinity timesteps... 
interp_coarse_to_obc : 273 of 732 salinity timesteps... 
interp_coarse_to_obc : 274 of 732 salinity timesteps... 
interp_coarse_to_obc : 275 of 732 salinity timesteps... 
interp_coarse_to_obc : 276 of 732 salinity timesteps... 
interp_coarse_to_obc : 277 of 732 salinity timesteps... 
interp_coarse_to_obc : 278 of 732 salinity timesteps... 
interp_coarse_to_obc : 279 of 732 salinity timesteps... 
interp_coarse_to_obc : 280 of 732 salinity timesteps... 
interp_coarse_to_obc : 281 of 732 salinity timesteps... 
interp_coarse_to_obc : 282 of 732 salinity timesteps... 
interp_coarse_to_obc : 283 of 732 salinity timesteps... 
interp_coarse_to_obc : 284 of 732 salinity timesteps... 
interp_coarse_to_obc : 285 of 732 salinity timesteps... 
interp_coarse_to_obc : 286 of 732 salinity timesteps... 
interp_coarse_to_obc : 287 of 732 salinity timesteps... 
interp_coarse_to_obc : 288 of 732 salinity timesteps... 
interp_coarse_to_obc : 289 of 732 salinity timesteps... 
interp_coarse_to_obc : 290 of 732 salinity timesteps... 
interp_coarse_to_obc : 291 of 732 salinity timesteps... 
interp_coarse_to_obc : 292 of 732 salinity timesteps... 
interp_coarse_to_obc : 293 of 732 salinity timesteps... 
interp_coarse_to_obc : 294 of 732 salinity timesteps... 
interp_coarse_to_obc : 295 of 732 salinity timesteps... 
interp_coarse_to_obc : 296 of 732 salinity timesteps... 
interp_coarse_to_obc : 297 of 732 salinity timesteps... 
interp_coarse_to_obc : 298 of 732 salinity timesteps... 
interp_coarse_to_obc : 299 of 732 salinity timesteps... 
interp_coarse_to_obc : 300 of 732 salinity timesteps... 
interp_coarse_to_obc : 301 of 732 salinity timesteps... 
interp_coarse_to_obc : 302 of 732 salinity timesteps... 
interp_coarse_to_obc : 303 of 732 salinity timesteps... 
interp_coarse_to_obc : 304 of 732 salinity timesteps... 
interp_coarse_to_obc : 305 of 732 salinity timesteps... 
interp_coarse_to_obc : 306 of 732 salinity timesteps... 
interp_coarse_to_obc : 307 of 732 salinity timesteps... 
interp_coarse_to_obc : 308 of 732 salinity timesteps... 
interp_coarse_to_obc : 309 of 732 salinity timesteps... 
interp_coarse_to_obc : 310 of 732 salinity timesteps... 
interp_coarse_to_obc : 311 of 732 salinity timesteps... 
interp_coarse_to_obc : 312 of 732 salinity timesteps... 
interp_coarse_to_obc : 313 of 732 salinity timesteps... 
interp_coarse_to_obc : 314 of 732 salinity timesteps... 
interp_coarse_to_obc : 315 of 732 salinity timesteps... 
interp_coarse_to_obc : 316 of 732 salinity timesteps... 
interp_coarse_to_obc : 317 of 732 salinity timesteps... 
interp_coarse_to_obc : 318 of 732 salinity timesteps... 
interp_coarse_to_obc : 319 of 732 salinity timesteps... 
interp_coarse_to_obc : 320 of 732 salinity timesteps... 
interp_coarse_to_obc : 321 of 732 salinity timesteps... 
interp_coarse_to_obc : 322 of 732 salinity timesteps... 
interp_coarse_to_obc : 323 of 732 salinity timesteps... 
interp_coarse_to_obc : 324 of 732 salinity timesteps... 
interp_coarse_to_obc : 325 of 732 salinity timesteps... 
interp_coarse_to_obc : 326 of 732 salinity timesteps... 
interp_coarse_to_obc : 327 of 732 salinity timesteps... 
interp_coarse_to_obc : 328 of 732 salinity timesteps... 
interp_coarse_to_obc : 329 of 732 salinity timesteps... 
interp_coarse_to_obc : 330 of 732 salinity timesteps... 
interp_coarse_to_obc : 331 of 732 salinity timesteps... 
interp_coarse_to_obc : 332 of 732 salinity timesteps... 
interp_coarse_to_obc : 333 of 732 salinity timesteps... 
interp_coarse_to_obc : 334 of 732 salinity timesteps... 
interp_coarse_to_obc : 335 of 732 salinity timesteps... 
interp_coarse_to_obc : 336 of 732 salinity timesteps... 
interp_coarse_to_obc : 337 of 732 salinity timesteps... 
interp_coarse_to_obc : 338 of 732 salinity timesteps... 
interp_coarse_to_obc : 339 of 732 salinity timesteps... 
interp_coarse_to_obc : 340 of 732 salinity timesteps... 
interp_coarse_to_obc : 341 of 732 salinity timesteps... 
interp_coarse_to_obc : 342 of 732 salinity timesteps... 
interp_coarse_to_obc : 343 of 732 salinity timesteps... 
interp_coarse_to_obc : 344 of 732 salinity timesteps... 
interp_coarse_to_obc : 345 of 732 salinity timesteps... 
interp_coarse_to_obc : 346 of 732 salinity timesteps... 
interp_coarse_to_obc : 347 of 732 salinity timesteps... 
interp_coarse_to_obc : 348 of 732 salinity timesteps... 
interp_coarse_to_obc : 349 of 732 salinity timesteps... 
interp_coarse_to_obc : 350 of 732 salinity timesteps... 
interp_coarse_to_obc : 351 of 732 salinity timesteps... 
interp_coarse_to_obc : 352 of 732 salinity timesteps... 
interp_coarse_to_obc : 353 of 732 salinity timesteps... 
interp_coarse_to_obc : 354 of 732 salinity timesteps... 
interp_coarse_to_obc : 355 of 732 salinity timesteps... 
interp_coarse_to_obc : 356 of 732 salinity timesteps... 
interp_coarse_to_obc : 357 of 732 salinity timesteps... 
interp_coarse_to_obc : 358 of 732 salinity timesteps... 
interp_coarse_to_obc : 359 of 732 salinity timesteps... 
interp_coarse_to_obc : 360 of 732 salinity timesteps... 
interp_coarse_to_obc : 361 of 732 salinity timesteps... 
interp_coarse_to_obc : 362 of 732 salinity timesteps... 
interp_coarse_to_obc : 363 of 732 salinity timesteps... 
interp_coarse_to_obc : 364 of 732 salinity timesteps... 
interp_coarse_to_obc : 365 of 732 salinity timesteps... 
interp_coarse_to_obc : 366 of 732 salinity timesteps... 
interp_coarse_to_obc : 367 of 732 salinity timesteps... 
interp_coarse_to_obc : 368 of 732 salinity timesteps... 
interp_coarse_to_obc : 369 of 732 salinity timesteps... 
interp_coarse_to_obc : 370 of 732 salinity timesteps... 
interp_coarse_to_obc : 371 of 732 salinity timesteps... 
interp_coarse_to_obc : 372 of 732 salinity timesteps... 
interp_coarse_to_obc : 373 of 732 salinity timesteps... 
interp_coarse_to_obc : 374 of 732 salinity timesteps... 
interp_coarse_to_obc : 375 of 732 salinity timesteps... 
interp_coarse_to_obc : 376 of 732 salinity timesteps... 
interp_coarse_to_obc : 377 of 732 salinity timesteps... 
interp_coarse_to_obc : 378 of 732 salinity timesteps... 
interp_coarse_to_obc : 379 of 732 salinity timesteps... 
interp_coarse_to_obc : 380 of 732 salinity timesteps... 
interp_coarse_to_obc : 381 of 732 salinity timesteps... 
interp_coarse_to_obc : 382 of 732 salinity timesteps... 
interp_coarse_to_obc : 383 of 732 salinity timesteps... 
interp_coarse_to_obc : 384 of 732 salinity timesteps... 
interp_coarse_to_obc : 385 of 732 salinity timesteps... 
interp_coarse_to_obc : 386 of 732 salinity timesteps... 
interp_coarse_to_obc : 387 of 732 salinity timesteps... 
interp_coarse_to_obc : 388 of 732 salinity timesteps... 
interp_coarse_to_obc : 389 of 732 salinity timesteps... 
interp_coarse_to_obc : 390 of 732 salinity timesteps... 
interp_coarse_to_obc : 391 of 732 salinity timesteps... 
interp_coarse_to_obc : 392 of 732 salinity timesteps... 
interp_coarse_to_obc : 393 of 732 salinity timesteps... 
interp_coarse_to_obc : 394 of 732 salinity timesteps... 
interp_coarse_to_obc : 395 of 732 salinity timesteps... 
interp_coarse_to_obc : 396 of 732 salinity timesteps... 
interp_coarse_to_obc : 397 of 732 salinity timesteps... 
interp_coarse_to_obc : 398 of 732 salinity timesteps... 
interp_coarse_to_obc : 399 of 732 salinity timesteps... 
interp_coarse_to_obc : 400 of 732 salinity timesteps... 
interp_coarse_to_obc : 401 of 732 salinity timesteps... 
interp_coarse_to_obc : 402 of 732 salinity timesteps... 
interp_coarse_to_obc : 403 of 732 salinity timesteps... 
interp_coarse_to_obc : 404 of 732 salinity timesteps... 
interp_coarse_to_obc : 405 of 732 salinity timesteps... 
interp_coarse_to_obc : 406 of 732 salinity timesteps... 
interp_coarse_to_obc : 407 of 732 salinity timesteps... 
interp_coarse_to_obc : 408 of 732 salinity timesteps... 
interp_coarse_to_obc : 409 of 732 salinity timesteps... 
interp_coarse_to_obc : 410 of 732 salinity timesteps... 
interp_coarse_to_obc : 411 of 732 salinity timesteps... 
interp_coarse_to_obc : 412 of 732 salinity timesteps... 
interp_coarse_to_obc : 413 of 732 salinity timesteps... 
interp_coarse_to_obc : 414 of 732 salinity timesteps... 
interp_coarse_to_obc : 415 of 732 salinity timesteps... 
interp_coarse_to_obc : 416 of 732 salinity timesteps... 
interp_coarse_to_obc : 417 of 732 salinity timesteps... 
interp_coarse_to_obc : 418 of 732 salinity timesteps... 
interp_coarse_to_obc : 419 of 732 salinity timesteps... 
interp_coarse_to_obc : 420 of 732 salinity timesteps... 
interp_coarse_to_obc : 421 of 732 salinity timesteps... 
interp_coarse_to_obc : 422 of 732 salinity timesteps... 
interp_coarse_to_obc : 423 of 732 salinity timesteps... 
interp_coarse_to_obc : 424 of 732 salinity timesteps... 
interp_coarse_to_obc : 425 of 732 salinity timesteps... 
interp_coarse_to_obc : 426 of 732 salinity timesteps... 
interp_coarse_to_obc : 427 of 732 salinity timesteps... 
interp_coarse_to_obc : 428 of 732 salinity timesteps... 
interp_coarse_to_obc : 429 of 732 salinity timesteps... 
interp_coarse_to_obc : 430 of 732 salinity timesteps... 
interp_coarse_to_obc : 431 of 732 salinity timesteps... 
interp_coarse_to_obc : 432 of 732 salinity timesteps... 
interp_coarse_to_obc : 433 of 732 salinity timesteps... 
interp_coarse_to_obc : 434 of 732 salinity timesteps... 
interp_coarse_to_obc : 435 of 732 salinity timesteps... 
interp_coarse_to_obc : 436 of 732 salinity timesteps... 
interp_coarse_to_obc : 437 of 732 salinity timesteps... 
interp_coarse_to_obc : 438 of 732 salinity timesteps... 
interp_coarse_to_obc : 439 of 732 salinity timesteps... 
interp_coarse_to_obc : 440 of 732 salinity timesteps... 
interp_coarse_to_obc : 441 of 732 salinity timesteps... 
interp_coarse_to_obc : 442 of 732 salinity timesteps... 
interp_coarse_to_obc : 443 of 732 salinity timesteps... 
interp_coarse_to_obc : 444 of 732 salinity timesteps... 
interp_coarse_to_obc : 445 of 732 salinity timesteps... 
interp_coarse_to_obc : 446 of 732 salinity timesteps... 
interp_coarse_to_obc : 447 of 732 salinity timesteps... 
interp_coarse_to_obc : 448 of 732 salinity timesteps... 
interp_coarse_to_obc : 449 of 732 salinity timesteps... 
interp_coarse_to_obc : 450 of 732 salinity timesteps... 
interp_coarse_to_obc : 451 of 732 salinity timesteps... 
interp_coarse_to_obc : 452 of 732 salinity timesteps... 
interp_coarse_to_obc : 453 of 732 salinity timesteps... 
interp_coarse_to_obc : 454 of 732 salinity timesteps... 
interp_coarse_to_obc : 455 of 732 salinity timesteps... 
interp_coarse_to_obc : 456 of 732 salinity timesteps... 
interp_coarse_to_obc : 457 of 732 salinity timesteps... 
interp_coarse_to_obc : 458 of 732 salinity timesteps... 
interp_coarse_to_obc : 459 of 732 salinity timesteps... 
interp_coarse_to_obc : 460 of 732 salinity timesteps... 
interp_coarse_to_obc : 461 of 732 salinity timesteps... 
interp_coarse_to_obc : 462 of 732 salinity timesteps... 
interp_coarse_to_obc : 463 of 732 salinity timesteps... 
interp_coarse_to_obc : 464 of 732 salinity timesteps... 
interp_coarse_to_obc : 465 of 732 salinity timesteps... 
interp_coarse_to_obc : 466 of 732 salinity timesteps... 
interp_coarse_to_obc : 467 of 732 salinity timesteps... 
interp_coarse_to_obc : 468 of 732 salinity timesteps... 
interp_coarse_to_obc : 469 of 732 salinity timesteps... 
interp_coarse_to_obc : 470 of 732 salinity timesteps... 
interp_coarse_to_obc : 471 of 732 salinity timesteps... 
interp_coarse_to_obc : 472 of 732 salinity timesteps... 
interp_coarse_to_obc : 473 of 732 salinity timesteps... 
interp_coarse_to_obc : 474 of 732 salinity timesteps... 
interp_coarse_to_obc : 475 of 732 salinity timesteps... 
interp_coarse_to_obc : 476 of 732 salinity timesteps... 
interp_coarse_to_obc : 477 of 732 salinity timesteps... 
interp_coarse_to_obc : 478 of 732 salinity timesteps... 
interp_coarse_to_obc : 479 of 732 salinity timesteps... 
interp_coarse_to_obc : 480 of 732 salinity timesteps... 
interp_coarse_to_obc : 481 of 732 salinity timesteps... 
interp_coarse_to_obc : 482 of 732 salinity timesteps... 
interp_coarse_to_obc : 483 of 732 salinity timesteps... 
interp_coarse_to_obc : 484 of 732 salinity timesteps... 
interp_coarse_to_obc : 485 of 732 salinity timesteps... 
interp_coarse_to_obc : 486 of 732 salinity timesteps... 
interp_coarse_to_obc : 487 of 732 salinity timesteps... 
interp_coarse_to_obc : 488 of 732 salinity timesteps... 
interp_coarse_to_obc : 489 of 732 salinity timesteps... 
interp_coarse_to_obc : 490 of 732 salinity timesteps... 
interp_coarse_to_obc : 491 of 732 salinity timesteps... 
interp_coarse_to_obc : 492 of 732 salinity timesteps... 
interp_coarse_to_obc : 493 of 732 salinity timesteps... 
interp_coarse_to_obc : 494 of 732 salinity timesteps... 
interp_coarse_to_obc : 495 of 732 salinity timesteps... 
interp_coarse_to_obc : 496 of 732 salinity timesteps... 
interp_coarse_to_obc : 497 of 732 salinity timesteps... 
interp_coarse_to_obc : 498 of 732 salinity timesteps... 
interp_coarse_to_obc : 499 of 732 salinity timesteps... 
interp_coarse_to_obc : 500 of 732 salinity timesteps... 
interp_coarse_to_obc : 501 of 732 salinity timesteps... 
interp_coarse_to_obc : 502 of 732 salinity timesteps... 
interp_coarse_to_obc : 503 of 732 salinity timesteps... 
interp_coarse_to_obc : 504 of 732 salinity timesteps... 
interp_coarse_to_obc : 505 of 732 salinity timesteps... 
interp_coarse_to_obc : 506 of 732 salinity timesteps... 
interp_coarse_to_obc : 507 of 732 salinity timesteps... 
interp_coarse_to_obc : 508 of 732 salinity timesteps... 
interp_coarse_to_obc : 509 of 732 salinity timesteps... 
interp_coarse_to_obc : 510 of 732 salinity timesteps... 
interp_coarse_to_obc : 511 of 732 salinity timesteps... 
interp_coarse_to_obc : 512 of 732 salinity timesteps... 
interp_coarse_to_obc : 513 of 732 salinity timesteps... 
interp_coarse_to_obc : 514 of 732 salinity timesteps... 
interp_coarse_to_obc : 515 of 732 salinity timesteps... 
interp_coarse_to_obc : 516 of 732 salinity timesteps... 
interp_coarse_to_obc : 517 of 732 salinity timesteps... 
interp_coarse_to_obc : 518 of 732 salinity timesteps... 
interp_coarse_to_obc : 519 of 732 salinity timesteps... 
interp_coarse_to_obc : 520 of 732 salinity timesteps... 
interp_coarse_to_obc : 521 of 732 salinity timesteps... 
interp_coarse_to_obc : 522 of 732 salinity timesteps... 
interp_coarse_to_obc : 523 of 732 salinity timesteps... 
interp_coarse_to_obc : 524 of 732 salinity timesteps... 
interp_coarse_to_obc : 525 of 732 salinity timesteps... 
interp_coarse_to_obc : 526 of 732 salinity timesteps... 
interp_coarse_to_obc : 527 of 732 salinity timesteps... 
interp_coarse_to_obc : 528 of 732 salinity timesteps... 
interp_coarse_to_obc : 529 of 732 salinity timesteps... 
interp_coarse_to_obc : 530 of 732 salinity timesteps... 
interp_coarse_to_obc : 531 of 732 salinity timesteps... 
interp_coarse_to_obc : 532 of 732 salinity timesteps... 
interp_coarse_to_obc : 533 of 732 salinity timesteps... 
interp_coarse_to_obc : 534 of 732 salinity timesteps... 
interp_coarse_to_obc : 535 of 732 salinity timesteps... 
interp_coarse_to_obc : 536 of 732 salinity timesteps... 
interp_coarse_to_obc : 537 of 732 salinity timesteps... 
interp_coarse_to_obc : 538 of 732 salinity timesteps... 
interp_coarse_to_obc : 539 of 732 salinity timesteps... 
interp_coarse_to_obc : 540 of 732 salinity timesteps... 
interp_coarse_to_obc : 541 of 732 salinity timesteps... 
interp_coarse_to_obc : 542 of 732 salinity timesteps... 
interp_coarse_to_obc : 543 of 732 salinity timesteps... 
interp_coarse_to_obc : 544 of 732 salinity timesteps... 
interp_coarse_to_obc : 545 of 732 salinity timesteps... 
interp_coarse_to_obc : 546 of 732 salinity timesteps... 
interp_coarse_to_obc : 547 of 732 salinity timesteps... 
interp_coarse_to_obc : 548 of 732 salinity timesteps... 
interp_coarse_to_obc : 549 of 732 salinity timesteps... 
interp_coarse_to_obc : 550 of 732 salinity timesteps... 
interp_coarse_to_obc : 551 of 732 salinity timesteps... 
interp_coarse_to_obc : 552 of 732 salinity timesteps... 
interp_coarse_to_obc : 553 of 732 salinity timesteps... 
interp_coarse_to_obc : 554 of 732 salinity timesteps... 
interp_coarse_to_obc : 555 of 732 salinity timesteps... 
interp_coarse_to_obc : 556 of 732 salinity timesteps... 
interp_coarse_to_obc : 557 of 732 salinity timesteps... 
interp_coarse_to_obc : 558 of 732 salinity timesteps... 
interp_coarse_to_obc : 559 of 732 salinity timesteps... 
interp_coarse_to_obc : 560 of 732 salinity timesteps... 
interp_coarse_to_obc : 561 of 732 salinity timesteps... 
interp_coarse_to_obc : 562 of 732 salinity timesteps... 
interp_coarse_to_obc : 563 of 732 salinity timesteps... 
interp_coarse_to_obc : 564 of 732 salinity timesteps... 
interp_coarse_to_obc : 565 of 732 salinity timesteps... 
interp_coarse_to_obc : 566 of 732 salinity timesteps... 
interp_coarse_to_obc : 567 of 732 salinity timesteps... 
interp_coarse_to_obc : 568 of 732 salinity timesteps... 
interp_coarse_to_obc : 569 of 732 salinity timesteps... 
interp_coarse_to_obc : 570 of 732 salinity timesteps... 
interp_coarse_to_obc : 571 of 732 salinity timesteps... 
interp_coarse_to_obc : 572 of 732 salinity timesteps... 
interp_coarse_to_obc : 573 of 732 salinity timesteps... 
interp_coarse_to_obc : 574 of 732 salinity timesteps... 
interp_coarse_to_obc : 575 of 732 salinity timesteps... 
interp_coarse_to_obc : 576 of 732 salinity timesteps... 
interp_coarse_to_obc : 577 of 732 salinity timesteps... 
interp_coarse_to_obc : 578 of 732 salinity timesteps... 
interp_coarse_to_obc : 579 of 732 salinity timesteps... 
interp_coarse_to_obc : 580 of 732 salinity timesteps... 
interp_coarse_to_obc : 581 of 732 salinity timesteps... 
interp_coarse_to_obc : 582 of 732 salinity timesteps... 
interp_coarse_to_obc : 583 of 732 salinity timesteps... 
interp_coarse_to_obc : 584 of 732 salinity timesteps... 
interp_coarse_to_obc : 585 of 732 salinity timesteps... 
interp_coarse_to_obc : 586 of 732 salinity timesteps... 
interp_coarse_to_obc : 587 of 732 salinity timesteps... 
interp_coarse_to_obc : 588 of 732 salinity timesteps... 
interp_coarse_to_obc : 589 of 732 salinity timesteps... 
interp_coarse_to_obc : 590 of 732 salinity timesteps... 
interp_coarse_to_obc : 591 of 732 salinity timesteps... 
interp_coarse_to_obc : 592 of 732 salinity timesteps... 
interp_coarse_to_obc : 593 of 732 salinity timesteps... 
interp_coarse_to_obc : 594 of 732 salinity timesteps... 
interp_coarse_to_obc : 595 of 732 salinity timesteps... 
interp_coarse_to_obc : 596 of 732 salinity timesteps... 
interp_coarse_to_obc : 597 of 732 salinity timesteps... 
interp_coarse_to_obc : 598 of 732 salinity timesteps... 
interp_coarse_to_obc : 599 of 732 salinity timesteps... 
interp_coarse_to_obc : 600 of 732 salinity timesteps... 
interp_coarse_to_obc : 601 of 732 salinity timesteps... 
interp_coarse_to_obc : 602 of 732 salinity timesteps... 
interp_coarse_to_obc : 603 of 732 salinity timesteps... 
interp_coarse_to_obc : 604 of 732 salinity timesteps... 
interp_coarse_to_obc : 605 of 732 salinity timesteps... 
interp_coarse_to_obc : 606 of 732 salinity timesteps... 
interp_coarse_to_obc : 607 of 732 salinity timesteps... 
interp_coarse_to_obc : 608 of 732 salinity timesteps... 
interp_coarse_to_obc : 609 of 732 salinity timesteps... 
interp_coarse_to_obc : 610 of 732 salinity timesteps... 
interp_coarse_to_obc : 611 of 732 salinity timesteps... 
interp_coarse_to_obc : 612 of 732 salinity timesteps... 
interp_coarse_to_obc : 613 of 732 salinity timesteps... 
interp_coarse_to_obc : 614 of 732 salinity timesteps... 
interp_coarse_to_obc : 615 of 732 salinity timesteps... 
interp_coarse_to_obc : 616 of 732 salinity timesteps... 
interp_coarse_to_obc : 617 of 732 salinity timesteps... 
interp_coarse_to_obc : 618 of 732 salinity timesteps... 
interp_coarse_to_obc : 619 of 732 salinity timesteps... 
interp_coarse_to_obc : 620 of 732 salinity timesteps... 
interp_coarse_to_obc : 621 of 732 salinity timesteps... 
interp_coarse_to_obc : 622 of 732 salinity timesteps... 
interp_coarse_to_obc : 623 of 732 salinity timesteps... 
interp_coarse_to_obc : 624 of 732 salinity timesteps... 
interp_coarse_to_obc : 625 of 732 salinity timesteps... 
interp_coarse_to_obc : 626 of 732 salinity timesteps... 
interp_coarse_to_obc : 627 of 732 salinity timesteps... 
interp_coarse_to_obc : 628 of 732 salinity timesteps... 
interp_coarse_to_obc : 629 of 732 salinity timesteps... 
interp_coarse_to_obc : 630 of 732 salinity timesteps... 
interp_coarse_to_obc : 631 of 732 salinity timesteps... 
interp_coarse_to_obc : 632 of 732 salinity timesteps... 
interp_coarse_to_obc : 633 of 732 salinity timesteps... 
interp_coarse_to_obc : 634 of 732 salinity timesteps... 
interp_coarse_to_obc : 635 of 732 salinity timesteps... 
interp_coarse_to_obc : 636 of 732 salinity timesteps... 
interp_coarse_to_obc : 637 of 732 salinity timesteps... 
interp_coarse_to_obc : 638 of 732 salinity timesteps... 
interp_coarse_to_obc : 639 of 732 salinity timesteps... 
interp_coarse_to_obc : 640 of 732 salinity timesteps... 
interp_coarse_to_obc : 641 of 732 salinity timesteps... 
interp_coarse_to_obc : 642 of 732 salinity timesteps... 
interp_coarse_to_obc : 643 of 732 salinity timesteps... 
interp_coarse_to_obc : 644 of 732 salinity timesteps... 
interp_coarse_to_obc : 645 of 732 salinity timesteps... 
interp_coarse_to_obc : 646 of 732 salinity timesteps... 
interp_coarse_to_obc : 647 of 732 salinity timesteps... 
interp_coarse_to_obc : 648 of 732 salinity timesteps... 
interp_coarse_to_obc : 649 of 732 salinity timesteps... 
interp_coarse_to_obc : 650 of 732 salinity timesteps... 
interp_coarse_to_obc : 651 of 732 salinity timesteps... 
interp_coarse_to_obc : 652 of 732 salinity timesteps... 
interp_coarse_to_obc : 653 of 732 salinity timesteps... 
interp_coarse_to_obc : 654 of 732 salinity timesteps... 
interp_coarse_to_obc : 655 of 732 salinity timesteps... 
interp_coarse_to_obc : 656 of 732 salinity timesteps... 
interp_coarse_to_obc : 657 of 732 salinity timesteps... 
interp_coarse_to_obc : 658 of 732 salinity timesteps... 
interp_coarse_to_obc : 659 of 732 salinity timesteps... 
interp_coarse_to_obc : 660 of 732 salinity timesteps... 
interp_coarse_to_obc : 661 of 732 salinity timesteps... 
interp_coarse_to_obc : 662 of 732 salinity timesteps... 
interp_coarse_to_obc : 663 of 732 salinity timesteps... 
interp_coarse_to_obc : 664 of 732 salinity timesteps... 
interp_coarse_to_obc : 665 of 732 salinity timesteps... 
interp_coarse_to_obc : 666 of 732 salinity timesteps... 
interp_coarse_to_obc : 667 of 732 salinity timesteps... 
interp_coarse_to_obc : 668 of 732 salinity timesteps... 
interp_coarse_to_obc : 669 of 732 salinity timesteps... 
interp_coarse_to_obc : 670 of 732 salinity timesteps... 
interp_coarse_to_obc : 671 of 732 salinity timesteps... 
interp_coarse_to_obc : 672 of 732 salinity timesteps... 
interp_coarse_to_obc : 673 of 732 salinity timesteps... 
interp_coarse_to_obc : 674 of 732 salinity timesteps... 
interp_coarse_to_obc : 675 of 732 salinity timesteps... 
interp_coarse_to_obc : 676 of 732 salinity timesteps... 
interp_coarse_to_obc : 677 of 732 salinity timesteps... 
interp_coarse_to_obc : 678 of 732 salinity timesteps... 
interp_coarse_to_obc : 679 of 732 salinity timesteps... 
interp_coarse_to_obc : 680 of 732 salinity timesteps... 
interp_coarse_to_obc : 681 of 732 salinity timesteps... 
interp_coarse_to_obc : 682 of 732 salinity timesteps... 
interp_coarse_to_obc : 683 of 732 salinity timesteps... 
interp_coarse_to_obc : 684 of 732 salinity timesteps... 
interp_coarse_to_obc : 685 of 732 salinity timesteps... 
interp_coarse_to_obc : 686 of 732 salinity timesteps... 
interp_coarse_to_obc : 687 of 732 salinity timesteps... 
interp_coarse_to_obc : 688 of 732 salinity timesteps... 
interp_coarse_to_obc : 689 of 732 salinity timesteps... 
interp_coarse_to_obc : 690 of 732 salinity timesteps... 
interp_coarse_to_obc : 691 of 732 salinity timesteps... 
interp_coarse_to_obc : 692 of 732 salinity timesteps... 
interp_coarse_to_obc : 693 of 732 salinity timesteps... 
interp_coarse_to_obc : 694 of 732 salinity timesteps... 
interp_coarse_to_obc : 695 of 732 salinity timesteps... 
interp_coarse_to_obc : 696 of 732 salinity timesteps... 
interp_coarse_to_obc : 697 of 732 salinity timesteps... 
interp_coarse_to_obc : 698 of 732 salinity timesteps... 
interp_coarse_to_obc : 699 of 732 salinity timesteps... 
interp_coarse_to_obc : 700 of 732 salinity timesteps... 
interp_coarse_to_obc : 701 of 732 salinity timesteps... 
interp_coarse_to_obc : 702 of 732 salinity timesteps... 
interp_coarse_to_obc : 703 of 732 salinity timesteps... 
interp_coarse_to_obc : 704 of 732 salinity timesteps... 
interp_coarse_to_obc : 705 of 732 salinity timesteps... 
interp_coarse_to_obc : 706 of 732 salinity timesteps... 
interp_coarse_to_obc : 707 of 732 salinity timesteps... 
interp_coarse_to_obc : 708 of 732 salinity timesteps... 
interp_coarse_to_obc : 709 of 732 salinity timesteps... 
interp_coarse_to_obc : 710 of 732 salinity timesteps... 
interp_coarse_to_obc : 711 of 732 salinity timesteps... 
interp_coarse_to_obc : 712 of 732 salinity timesteps... 
interp_coarse_to_obc : 713 of 732 salinity timesteps... 
interp_coarse_to_obc : 714 of 732 salinity timesteps... 
interp_coarse_to_obc : 715 of 732 salinity timesteps... 
interp_coarse_to_obc : 716 of 732 salinity timesteps... 
interp_coarse_to_obc : 717 of 732 salinity timesteps... 
interp_coarse_to_obc : 718 of 732 salinity timesteps... 
interp_coarse_to_obc : 719 of 732 salinity timesteps... 
interp_coarse_to_obc : 720 of 732 salinity timesteps... 
interp_coarse_to_obc : 721 of 732 salinity timesteps... 
interp_coarse_to_obc : 722 of 732 salinity timesteps... 
interp_coarse_to_obc : 723 of 732 salinity timesteps... 
interp_coarse_to_obc : 724 of 732 salinity timesteps... 
interp_coarse_to_obc : 725 of 732 salinity timesteps... 
interp_coarse_to_obc : 726 of 732 salinity timesteps... 
interp_coarse_to_obc : 727 of 732 salinity timesteps... 
interp_coarse_to_obc : 728 of 732 salinity timesteps... 
interp_coarse_to_obc : 729 of 732 salinity timesteps... 
interp_coarse_to_obc : 730 of 732 salinity timesteps... 
interp_coarse_to_obc : 731 of 732 salinity timesteps... 
interp_coarse_to_obc : 732 of 732 salinity timesteps... 
[Warning: Integer operands are required for colon operator when used as index.] 
[> In get_HYCOM_series (line 37)] 
fprintf('Open boundary ST forcing making time: %.2f minutes\n', toc / 60)
Open boundary ST forcing making time: 35.73 minutes

tic
% Write the temperature and salinity.
if strcmpi('HYCOM', {inputConf.obc_temp, inputConf.obc_salt})
    fprintf('Writing daliy open boundary S&T forcing file.\n')
    write_FVCOM_tsobc(fullfile(inputConf.outbase, inputConf.casename), ...
        Mobj.ts_times, ...
        size(Mobj.temperature, 2), ...
        Mobj.temperature, ...
        Mobj.salt, ...
        Mobj, ...
        'floattime', true,...
        'julian', true);
end
Writing daliy open boundary S&T forcing file.

% Write the meanflow.
if strcmpi('HYCOM', {inputConf.obc_u, inputConf.obc_v})
    fprintf('Writing daliy open boundary meanflow file.\n')
    write_FVCOM_meanflow(Mobj, ...
        fullfile(inputConf.outbase,[inputConf.casename,'_mfobc.nc']), ...
        Mobj.velocity);
end

% plot temp and salt
% plot(datetime(Mobj.ts_times+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),squeeze(Mobj.temperature(1,1,:)));
% plot(datetime(Mobj.ts_times+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),squeeze(Mobj.salt(1,1,:)));

%%
%%%------------------------------------------------------------------------
%%%                     Meteorology and output
%%%------------------------------------------------------------------------
% Get the surface heating data.
if strcmpi(inputConf.doForcing, 'NCEP')
    
    % Use the OPeNDAP NCEP script to get the following parameters:
    %     - Potential evaporation rate (pevpr)[W/m^2]                   : for extracting land mask
    %     - u wind component (uwnd)[m/s]                                : for wind
    %     - v wind component (vwnd)[m/s]                                : for wind
    %     - Precipitation rate (prate)[Kg/m^2/s]                        : for precipitation
    %     - Downward Longwave Radiation Flux at Surface (dlwrf) [W/m^2] : for heat flux
    %     - Downward Solar Radiation Flux at Surface (dswrf) [W/m^2]    : for heat flux
    %     - Upward Longwave Radiation Flux at Surface (ulwrf) [W/m^2]   : for heat flux
    %     - Upward Solar Radiation Flux at Surface (uswrf) [W/m^2]      : for heat flux
    %     - Sea level pressure (pres) [Pa]                              : for air pressure
    %     - Air temperature at 2 m (air) [Kelvins]
    %     - Relative Humidity on Pressure Levels (rhum) [%]
    % The script also calculate the following parameters:
    %     - Momentum flux (tau)
    %     - Net solar radiation surface (nswrs = uswrf - dswrf)
    %     - Net longwave radiation surface (nlwrs = ulwrf - dlwrf)

    if develop_mode == 3
    	fprintf('Loading Model objet file...\n')
        load([inputConf.outbase,'varb/Mobj_03.mat']);
        load([inputConf.outbase,'varb/forcing_interp.mat']);
        fprintf('Done!\n');
    else
    	if develop_mode == 1
        	% The script converts the NCEP data from the OPeNDAP server from longitudes 
        	% in the 0 to 360 range to the latitudes in the -180 to 180 range. 
        	% It also subsets for the right region (defined by Mobj.lon and Mobj.lat).
        	% Uncomment the variables in get_NCEP_forcing as the varlist shows.
        	fprintf('Downloading NCEP forcing from OPeNDAP server database...\n')
            % modelTime=inputConf.forceMJD; varargin
        	forcing_ncep = get_NCEP_forcing(Mobj, inputConf.forceMJD, ...
        	    'varlist', {...
        	    'uwnd', 'vwnd',...
        	    'uswrf', 'ulwrf', 'dswrf', 'dlwrf',...
        	    'prate', 'pres','air', 'rhum','pevpr'},...
        	    'source', 'reanalysis2');
        	forcing_ncep.domain_cols = length(forcing_ncep.lon);
        	forcing_ncep.domain_rows = length(forcing_ncep.lat);
        	if isfield(forcing_ncep, 'rhum')||isfield(forcing_ncep, 'pres')
        	    forcing_ncep.domain_cols_alt = length(forcing_ncep.rhum.lon);
        	    forcing_ncep.domain_rows_alt = length(forcing_ncep.rhum.lat);
        	end
        	% Convert the small subdomain into cartesian coordinates. We need
        	% to do this twice because some of the NCEP data are on different
        	% grids (e.g. sea level pressure, relative humidity etc.).
        	tmpZone = regexpi(inputConf.utmZone,'\ ','split');
        	[tmpLon, tmpLat] = meshgrid(forcing_ncep.lon, forcing_ncep.lat);
        	[forcing_ncep.x, forcing_ncep.y] = wgs2utm(tmpLat(:), tmpLon(:), str2double(char(tmpZone{1}(1))), char(tmpZone{1}(2)));
        	if isfield(forcing_ncep, 'rhum')||isfield(forcing_ncep, 'pres')
        	    [tmpLon2, tmpLat2] = meshgrid(forcing_ncep.rhum.lon, forcing_ncep.rhum.lat);
        	    [forcing_ncep.xalt, forcing_ncep.yalt] = wgs2utm(tmpLat2(:), tmpLon2(:), str2double(char(tmpZone{1}(1))), char(tmpZone{1}(2)));
        	end
        	clear tmpLon tmpLat tmpLon2 tmpLat2 tmpZone
        	% Create arrays of the x and y positions.
        	forcing_ncep.x = reshape(forcing_ncep.x, forcing_ncep.domain_rows, forcing_ncep.domain_cols);
        	forcing_ncep.y = reshape(forcing_ncep.y, forcing_ncep.domain_rows, forcing_ncep.domain_cols);
        	if isfield(forcing_ncep, 'rhum')||isfield(forcing_ncep, 'pres')
        	    forcing_ncep.xalt = reshape(forcing_ncep.xalt, forcing_ncep.domain_rows_alt, forcing_ncep.domain_cols_alt);
        	    forcing_ncep.yalt = reshape(forcing_ncep.yalt, forcing_ncep.domain_rows_alt, forcing_ncep.domain_cols_alt);
        	end
        	[forcing_ncep.lon, forcing_ncep.lat] = meshgrid(forcing_ncep.lon, forcing_ncep.lat);
        	forcing_ncep = rmfield(forcing_ncep, {'domain_rows', 'domain_cols'});
        	if isfield(forcing_ncep, 'rhum')||isfield(forcing_ncep, 'pres')
        	    forcing_ncep = rmfield(forcing_ncep, {'domain_rows_alt', 'domain_cols_alt'});
        	end
        	fprintf('Saving NCEP forcing from OPeNDAP server database...')
        	save([inputConf.outbase,'forcing_ncep.mat'],'forcing_ncep','-v7.3','-nocompression');
        	fprintf('Done\n')
            % % Have a look at some data.
            %{
            for i=1:240%size(forcing_ncep.air.data, 3)
                figure1 = figure(1);
                ax = axes('Parent',figure1);
                clf
                %           1      2     3      4     ???5      6     7     8
                varb = {'uwnd','vwnd','air','rhum','prate','pres'};
                %value = sqrt(forcing_ncep.(varb{1}).data(:, :, i).^2 + forcing_ncep.(varb{2}).data(:, :, i).^2);
                value = forcing_ncep.(varb{3}).data(:,:,i);
                [X, Y] = meshgrid(forcing_ncep.lon, forcing_ncep.lat);
                s = pcolor(forcing_ncep.lon, forcing_ncep.lat, value);
                shading flat
                s.FaceColor = 'interp';
                axis('equal','tight')
                ylabel('Latitude (degree)','FontSize',12);
                xlabel('Longtitude (degree)','FontSize',12);
                pause(0.01);
            end
            clear ans ax figure1 i s value varb
            plot(squeeze(forcing_ncep.nswrs.data(2,4,1:36)));
            hold on;
            plot(squeeze(forcing_ncep.nlwrs.data(2,4,1:36)));
            hold on;
            plot(squeeze(forcing_ncep.shtfl.data(2,4,1:36)));
            hold on;
            plot(squeeze(forcing_ncep.lhtfl.data(2,4,1:36)));
            % The result of reanalysis2 shows the sensible and 
            % latent is totaly wrong.
            % reanalysis2 shtfl and lhtfl can not be used.
            %}
        elseif develop_mode == 2
    		fprintf('Loading NCEP forcing from the local database...');
        	load([inputConf.outbase,'forcing_ncep.mat']);
        	fprintf('Done!\n');
    	end
        % Interpolate the data onto the FVCOM unstructured grid.
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
        	    'uwnd', 'vwnd',...
        	    'uswrf', 'ulwrf', 'dswrf', 'dlwrf',...
        	    'prate', 'pres', 'air', 'rhum','pevpr'};
        forcing_ncep_interp = grid2fvcom(Mobj, interpfields, forcing_ncep,...
            'add_elems', true);

        % save('varb/Mobj_03.mat','Mobj','-v7.3','-nocompression');
        % save('forcing_interp.mat','forcing_interp','-v7.3','-nocompression');
    end
    % elseif strcmpi(inputConf.doForcing, 'NCEP-CALCULATED')
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.uwnd.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.vwnd.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.prate.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.evap.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.nswrs.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.dlwrf.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.air.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.pres.node(1,:));
    % plot(datetime(forcing_interp_calculated.time+678942,'ConvertFrom','datenum','TimeZone','Asia/Tokyo'),forcing_interp_calculated.rhum.node(1,:));
    % write_FVCOM_forcing_calculated(Mobj, ...
    %     fullfile(inputConf.outbase,inputConf.casename),...
    %     forcing_interp_calculated,...
    %     [inputConf.doForcing, 'atmospheric forcing data'],...
    %     inputConf.FVCOM_version, ...
    %     'floattime', true,...
    %     'julian', true);
    % fileprefix=fullfile(inputConf.outbase,inputConf.casename);
    % data=forcing_interp_calculated;
    % infos=[inputConf.doForcing, 'atmospheric forcing data'];
    % fver=inputConf.FVCOM_version;

elseif strcmpi(inputConf.doForcing, 'GWO')
    
    % Get the surface heating data.
    % Use the GWO data to get the following parameters:
    % - u wind component (uwnd)[m/s]                       : for wind
    % - v wind component (vwnd)[m/s]                       : for wind
    % - Precipitation rate (prate)[m/s]                    : for precipitation
    % - Solar Radiation Flux (dsw) [W/m^2]                 : for heat flux
    % - Sea level pressure (pres) [Pa]                     : for air pressure
    % - Air temperature at ? m (air) [deg C]               : for temperature
    % - Relative Humidity on Pressure Levels (rhum) [%]    : for relative humidity
    % - Cloud coverage (cloud)

    % Generate the following variables for FVCOM net sea surface heat flux and sea
    % surface shortwave radiation. For this purpose, heat_calculated and custom
    % created dlw_calculated options are actived.
    %  &NML_SURFACE_FORCING
    %  WIND_ON                         = T,
    %  WIND_TYPE                       = 'speed',
    %  WIND_FILE                       = 'tokyobay_hfx.nc', 
    %  &NML_HEATING_CALCULATED
    %  HEATING_CALCULATE_ON            = T,
    %  HEATING_CALCULATE_TYPE          = 'flux',
    %  HEATING_CALCULATE_FILE          = 'tokyobay_hfx.nc',
    %  COARE_VERSION                   = 'BULKALGORITHM',
    %  The air pressure is not turnning on.
    %  This is used for non calculated heat flux and hurrican model.
    
    if develop_mode == 3
    	fprintf('Loading Model objet file...\n')
        load([inputConf.outbase,'varb/Mobj_03.mat']);
        % load('forcing_gwo.mat');
        load([inputConf.outbase,'forcing_gwo_interp.mat']);
        fprintf('Done!\n');
    else
        Mobj.gwo.time = inputConf.forceMJD';
        if develop_mode == 1
            forcing_gwo = get_GWO_forcing(Mobj.gwo.time);
            UTMzone = regexpi(inputConf.utmZone,'\ ','split');
            for s = 1:length(forcing_gwo.lon)
                [forcing_gwo.x(s),forcing_gwo.y(s),~,~] = wgs2utm(...
                    forcing_gwo.lat(s),forcing_gwo.lon(s),...
                    str2double(char(UTMzone{1}(1))),char(UTMzone{1}(2)));
            end
            [forcing_gwo.x,forcing_gwo.y] = meshgrid(forcing_gwo.x,forcing_gwo.y);
            clear s UTMzone
            save([inputConf.outbase,'forcing_gwo.mat'],'forcing_gwo','-v7.3','-nocompression');
            save([inputConf.outbase,'varb/Mobj_03.mat'],'Mobj','-v7.3','-nocompression');
        elseif develop_mode == 2
    		fprintf('Loading GWO forcing from the local database...');
        	load('forcing_gwo.mat');
            save([inputConf.outbase,'varb/Mobj_03.mat'],'Mobj','-v7.3','-nocompression');
        	fprintf('Done!\n');
        end
        % air
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'air'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_air = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_air.mat'],'forcing_gwo_inter_air','-v7.3','-nocompression');
        clear forcing_gwo_inter_air;
        
        % cld
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'cld'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_cld = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_cld.mat'],'forcing_gwo_inter_cld','-v7.3','-nocompression');
        clear forcing_gwo_inter_cld;
        
        % dsw
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'dsw'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_dsw = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_dsw.mat'],'forcing_gwo_inter_dsw','-v7.3','-nocompression');
        clear forcing_gwo_inter_dsw;
        
        % hum
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'hum'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_hum = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_hum.mat'],'forcing_gwo_inter_hum','-v7.3','-nocompression');
        clear forcing_gwo_inter_hum;
        
        % prs
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'prs'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_prs = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_prs.mat'],'forcing_gwo_inter_prs','-v7.3','-nocompression');
        clear forcing_gwo_inter_prs;
        
        % wnd
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'uwnd','vwnd'};
        % vars = interpfields; data = forcing_gwo;
        forcing_gwo_inter_wnd = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', true);
        save([inputConf.outbase,'forcing_gwo_inter_wnd.mat'],'forcing_gwo_inter_wnd','-v7.3','-nocompression');
        clear forcing_gwo_inter_wnd;
        
        % rin
        interpfields = {'time', 'lon', 'lat', 'x', 'y',...
            'rin'};
        % vars = interpfields; data = forcing;
        forcing_gwo_inter_rin = grid2fvcom(Mobj, interpfields, forcing_gwo,...
            'add_elems', false);
        save([inputConf.outbase,'forcing_gwo_inter_rin.mat'],'forcing_gwo_inter_rin','-v7.3','-nocompression');
        clear forcing_gwo_inter_rin;
        clear forcing_gwo;
        clear interpfields;
        
        load([inputConf.outbase,'forcing_gwo_inter_air.mat']); forcing_gwo_interp.air = forcing_gwo_inter_air.air; clear forcing_gwo_inter_air;
        load([inputConf.outbase,'forcing_gwo_inter_cld.mat']); forcing_gwo_interp.cld = forcing_gwo_inter_cld.cld; clear forcing_gwo_inter_cld;
        load([inputConf.outbase,'forcing_gwo_inter_dsw.mat']); forcing_gwo_interp.dsw = forcing_gwo_inter_dsw.dsw; clear forcing_gwo_inter_dsw;
        load([inputConf.outbase,'forcing_gwo_inter_hum.mat']); forcing_gwo_interp.hum = forcing_gwo_inter_hum.hum; clear forcing_gwo_inter_hum;
        load([inputConf.outbase,'forcing_gwo_inter_prs.mat']); forcing_gwo_interp.prs = forcing_gwo_inter_prs.prs; clear forcing_gwo_inter_prs;
        load([inputConf.outbase,'forcing_gwo_inter_rin.mat']); forcing_gwo_interp.rin = forcing_gwo_inter_rin.rin; clear forcing_gwo_inter_rin;
        load([inputConf.outbase,'forcing_gwo_inter_wnd.mat']); 
        forcing_gwo_interp.uwnd = forcing_gwo_inter_wnd.uwnd; 
        forcing_gwo_interp.vwnd = forcing_gwo_inter_wnd.vwnd; 
        forcing_gwo_interp.time = forcing_gwo_inter_wnd.time;
        forcing_gwo_interp.lon  = forcing_gwo_inter_wnd.lon; 
        forcing_gwo_interp.lat  = forcing_gwo_inter_wnd.lat; 
        forcing_gwo_interp.x    = forcing_gwo_inter_wnd.x; 
        forcing_gwo_interp.y    = forcing_gwo_inter_wnd.y; 
        clear forcing_gwo_inter_wnd;
        
        save([inputConf.outbase,'forcing_gwo_interp.mat'],'forcing_gwo_interp','-v7.3','-nocompression');
    end

    write_FVCOM_gwo_forcing(Mobj, ...
        forcing_gwo_interp, ...
        fullfile(inputConf.outbase,[inputConf.casename]),...
        [inputConf.doForcing, ' atmospheric forcing data'],...
        inputConf.FVCOM_version, ...
        'floattime', true,...
        'julian', true);
    fprintf('Writing meteorological forcing file...done!\n');
    clear forcing_gwo forcing_gwo_interp;
    
% Have a look at some data.
%{
for i=1:240%size(forcing.air.data, 3)
    figure1 = figure(1);
    ax = axes('Parent',figure1);
    clf
    %           1      2     3     4     5     6     7     8
    varb = {'uwnd','vwnd','air','hum','rin','prs','cld','dsw'};
    %value = sqrt(forcing_gwo.(varb{1}).data(:, :, i).^2 + forcing_gwo.(varb{2}).data(:, :, i).^2);
    value = forcing_gwo.(varb{8}).data(:,:,i);
    s = pcolor(forcing_gwo.lon, forcing_gwo.lat, value');
    shading flat
    s.FaceColor = 'interp';
    axis('equal','tight')
    ylabel('Latitude (degree)','FontSize',12);
    xlabel('Longtitude (degree)','FontSize',12);
    pause(0.01);
end
clear ans ax figure1 i s value varb
%}

end
Loading GWO forcing from the local database...Done!
[Warning: File: /Users/yulong/GitHub/fvcomtoolbox/utilities/grid2fvcom.m Line:
272 Column: 55
The temporary variable xxalt will be cleared at the beginning of each iteration
of the parfor loop.
Any value assigned to it before the loop will be lost.  If xxalt is used before
it is assigned in the parfor loop, a runtime error will occur.
See Parallel for Loops in MATLAB, "Temporary Variables".] 
[Warning: File: /Users/yulong/GitHub/fvcomtoolbox/utilities/grid2fvcom.m Line:
275 Column: 25
The temporary variable yyalt will be cleared at the beginning of each iteration
of the parfor loop.
Any value assigned to it before the loop will be lost.  If yyalt is used before
it is assigned in the parfor loop, a runtime error will occur.
See Parallel for Loops in MATLAB, "Temporary Variables".] 
[Warning: File: /Users/yulong/GitHub/fvcomtoolbox/utilities/grid2fvcom.m Line:
291 Column: 44
The temporary variable ftsin will be cleared at the beginning of each iteration
of the parfor loop.
Any value assigned to it before the loop will be lost.  If ftsin is used before
it is assigned in the parfor loop, a runtime error will occur.
See Parallel for Loops in MATLAB, "Temporary Variables".] 

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of air complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of cld complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of dsw complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of hum complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of prs complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of uwnd complete
interpolation of vwnd complete

begin : grid2fvcom 
number of nodes: 6264
number of elems: 10876
transferring variable time as is
reassigning variable lon from unstructured grid
reassigning variable lat from unstructured grid
reassigning variable x from unstructured grid
reassigning variable y from unstructured grid
interpolation of rin complete
write : air... 
write : cld... 
write : dsw... 
write : hum... 
write : prs... 
write : rin... 
write : uwnd... 
write : vwnd... 
Writing meteorological forcing file...done!
IdleTimeout has been reached.
Parallel pool using the 'local' profile is shutting down.
%%
%%%------------------------------------------------------------------------
%%%                     River discharge and output
%%%------------------------------------------------------------------------
% FVCOM river.
if strcmpi(inputConf.riverForcing, 'FLUX')
    if develop_mode == 3
    	fprintf('Loading Model objet file...')
        load([inputConf.outbase,'varb/Mobj_04.mat']);
        fprintf('Done!\n');
    else
        fprintf('Reading river forcing file...');
        Mobj = get_COSTUM_river_location(inputConf, Mobj);
        Mobj = get_COSTUM_river_variable(Mobj, ...
            {inputConf.river.flux,inputConf.river.temp,inputConf.river.salt}, ...
            {'flux','temp','salt'},...
            inputConf.river.infos,...
            'time', true);
        Mobj.nRivers = Mobj.river.number;
        inc = 1;
        Mobj.rivermouth = cell(1); % don't preallocate as we don't know how many we'll have
        for s = 1:Mobj.nRivers
            [node, ~] = find_nearest_pt(Mobj.river.location(s, 3), Mobj.river.location(s, 4), Mobj);
            [~, elem] = min(abs(sqrt((Mobj.xc - Mobj.river.location(s, 3)).^2 + Mobj.yc - Mobj.river.location(s, 4)).^2));
            Mobj.rivermouth{inc} = {inc, Mobj.river.location(s, 3), Mobj.river.location(s, 4), node, Mobj.h(node), Mobj.river.name(s), elem};
            riverList(s,1) = Mobj.rivermouth{inc}(1,4);
            Mobj.riverList = cell2mat(riverList);
            inc = inc + 1;
        end
        clear node elem inc s
        Mobj = add_river_nodes_list(Mobj,Mobj.riverList,Mobj.river.name,1);
        save([inputConf.outbase,'varb/Mobj_04.mat'],'Mobj','-v7.3','-nocompression');
        fprintf('Done!\n');
        clear riverList;
    end
    % river file
    fprintf('Writing river forcing file...\n');
    write_FVCOM_river(fullfile(inputConf.outbase,...
        [inputConf.casename,'_river.nc']),...
         inputConf.river.infos,...
         Mobj.river.timeMJD,...
         Mobj.river.flux,...
         Mobj.river.temp -3.0,...
         Mobj.river.salt,...
        'Tokyo Bay rivers',...
        'Model river boundary input');
    write_FVCOM_river_nml(Mobj, ...
        fullfile(inputConf.outbase,'rivers_namelist.nml'), ...
        [inputConf.casename,'_river.nc'],...
        '''uniform''');
    fprintf('Done!\n');
end
Reading river forcing file...
WARNING: River time begin from 2014-01-01 00:00:00
Done!
Writing river forcing file...
Done!

%%
clear ans tpxo_dir
fprintf('All done!\n')
All done!
diary off;
